# owlRD原型项目 - 项目启动聊天记录

**时间**: 2025-11-20 13:33 - 13:50  
**会话主题**: 项目需求确认与技术方案讨论

---

## 📋 需求确认

### 用户需求

1. **源项目**: https://github.com/sady37/owlRD - 已clone到本地 `owdRD_github_clone_源参考文件`

2. **项目目标**:
   - 基于源参考文件创建owlRD原型项目
   - 以Web形式展现完整功能
   - **不能简化任何逻辑和内容** - 必须完整实现所有源参考文件的功能

3. **技术要求**:
   - 使用Python实现后端
   - **不使用数据库** - 改用JSON文件存储
   - Web界面展现

4. **校验机制**:
   - 需要与`owdRD_github_clone_源参考文件`形成校验机制
   - 当源参考文件更新时，能够检测差异并修正原型项目

5. **文档要求**:
   - 项目根目录必须有README.md
   - 随着开发进度持续更新README.md
   - 所有聊天记录自动保存到`项目聊天记录`目录

6. **项目同步**:
   - 项目根目录需要与GitHub同步

---

## 🏗️ 源项目分析

### 项目概述
**WiseFido/owlRD** - 智慧养老IoT监测系统，专注于老年护理机构的跌倒监测和生理健康预警

### 核心功能模块

#### 1. 实时监测系统
- **跌倒检测**: 基于雷达轨迹和高度变化的多级确认机制
- **生命体征**: 非接触式监测呼吸率（RR）、心率（HR）
- **行为识别**: 上床、离床、坐起等动作识别
- **姿态监测**: 基于SNOMED CT标准的姿态编码

#### 2. 护理质量评估
- **空间智能分析**: 基于护工-住户距离计算有效护理时长
- **团队级报告**: 按护士组聚合指标，完全匿名
- **趋势分析**: 7天/30天趋势跟踪
- **护理指标**: 覆盖率、有效时长、响应时间等

#### 3. 健康基线建模
- **个人基线**: 基于过去7天数据建立动态健康基线
- **异常检测**: 识别睡眠异常、活动下降等风险信号
- **预警机制**: 结合护理质量与住户状态的智能预警

#### 4. 多级报警系统
- **L1 (EMERGENCY)**: 紧急，立即报警，所有终端接收
- **L2 (ALERT)**: 高危事件，网页显示，App/Watch选择发送
- **L3 (CRITICAL)**: 严重，需关注，网页显示，不响警号
- **L5 (WARNING)**: 警告，本地确认 + Server计算确认
- **L8 (DEBUG)**: 内部记录，AI标识与训练

#### 5. IoT设备管理
- **TDPv2协议**: Telemetry Data Protocol v2，基于Protobuf
- **设备类型**: 雷达传感器、压力板、床头主机、警灯
- **数据流**: 实时数据、统计数据、事件上报

#### 6. 数据模型

##### Person Matrix (人员矩阵)
- 空间位置: pos_x, pos_y, pos_z
- 速度信息: vel_x, vel_y, vel_z
- 姿态状态: posture (SNOMED CT编码)
- 运动状态: motion_state (SNOMED CT编码)
- 健康状况: health_score (SNOMED CT编码)

##### Object Matrix (物体矩阵)
- 床、轮椅、沙发等物体识别
- 危险区域标注
- 房间布局管理

#### 7. 卡片系统
- **ActiveBed卡片**: 床位级监控，路由到指定护士
- **Location卡片**: 位置级监控，公共空间/个人空间
- **卡片权限**: 基于角色的访问控制
- **卡片自动生成**: 基于SQL函数的自动化创建

#### 8. 医疗标准集成
- **SNOMED CT**: 姿态、运动、健康状况的医疗编码
- **FHIR**: HL7 FHIR数据交换标准
- **HIPAA合规**: 隐私保护和数据安全

#### 9. AI训练与持续学习
- 云端数据增强（特征提取、多源融合）
- 多源数据融合（雷达、压力板、房间布局）
- 时序特征提取
- 人工反馈标签生成

#### 10. 多租户架构
- 租户隔离
- 角色权限管理
- 配置版本控制

### 数据库结构（19个表）
1. extensions (PostgreSQL扩展)
2. tenants (租户)
3. roles (角色)
4. users (用户)
5. locations (位置/地址)
6. rooms (房间)
7. beds (床位)
8. residents (住户 - 完全匿名化)
9. resident_phi (住户健康信息 - 加密)
10. resident_contacts (住户联系人)
11. resident_caregivers (护理人员关系)
12. devices (IoT设备)
13. iot_timeseries (IoT时序数据 - TimescaleDB)
14. iot_monitor_alerts (IoT监控警报)
15. cloud_alert_policies (云端警报策略)
16. config_versions (配置版本)
17. mapping_tables (映射表)
18. cards (卡片)
19. card_functions (卡片自动生成函数)

---

## 💡 初步技术方案（已讨论）

### 后端架构
- **框架**: FastAPI (异步、高性能、自动文档)
- **数据存储**: JSON文件 (替代PostgreSQL)
- **数据验证**: Pydantic模型
- **配置管理**: python-dotenv
- **文件IO**: aiofiles (异步)

### 前端架构
- **框架**: React 18 + TypeScript
- **样式**: TailwindCSS
- **组件库**: shadcn/ui
- **图表**: Recharts
- **数据获取**: React Query

### 校验机制
- **方案**: 结构化对比（推荐）
- **实现**: 解析SQL和Markdown，提取数据结构，生成差异报告

### 聊天记录自动保存
- **格式**: JSON/Markdown
- **命名**: `YYYY-MM-DD_HHMM_主题.md`

---

## ⚠️ 重要约束

1. **完整性要求**: 不能简化任何功能和逻辑
2. **数据结构**: 必须完全映射SQL表结构到JSON
3. **SNOMED CT**: 必须实现完整的医疗编码
4. **TDPv2协议**: 必须实现Protobuf协议解析
5. **多级报警**: 必须实现完整的报警机制
6. **卡片系统**: 必须实现完整的卡片自动生成逻辑
7. **护理评估**: 必须实现完整的护理质量评估算法

---

## 📝 下一步行动

**等待用户确认后开始**:
1. 创建项目目录结构
2. 读取所有数据库SQL文件
3. 读取所有文档文件
4. 制定详细开发计划
5. 创建项目README.md
6. 开始逐模块实现

---

**记录人**: Cascade AI  
**最后更新**: 2025-11-20 13:50
