---
trigger: always_on
description: "标准项目模板与目录结构规范"
---

# 项目结构与配置

**规则类型**: 🔴 强制规则  
**适用场景**: 创建新项目或组织项目结构时  
**版本**: v2.0 - 标准化模板

---

## 🎯 核心原则

### 1. 标准化优先
- 使用统一的项目模板
- 保持所有项目结构一致
- 便于复用和维护

### 2. 灵活适配
- 必需目录必须创建
- 可选目录按需创建
- 适应不同项目类型

### 3. 自动化创建
- 规则包含创建脚本
- 一键生成标准目录
- 减少手动操作

---

## 📁 标准项目模板

### 根目录结构（必需）

```
[项目名称]/
 .windsurf/              必需 - Windsurf配置
    rules/              规则系统（00-09或00-10）
 project-code/           必需 - 项目代码
    backend/            后端代码（如适用）
    frontend/           前端代码（如适用）
    tests/              测试文件
    README.md           代码说明
 项目文档/               必需 - 项目文档
    1-需求与设计/        必需 - 需求、架构、设计
    2-开发记录/          必需 - 开发过程记录
    3-部署运维/          必需 - 部署、配置、运维
    4-完成度检查/        可选 - 质量检查、对照验证
    9-归档/              必需 - 历史归档
    README.md           必需 - 文档索引
    项目状态.json        可选 - 项目状态
 知识库/                  可选 - 源参考资料（只读）
 .gitignore              必需 - Git忽略规则
 README.md               必需 - 项目总说明
```

---

## 🔧 目录说明

### 1. .windsurf/rules/ （必需）
**用途**: 存放Windsurf规则系统  
**内容**: 00-09（或00-10）规则文件  
**规则**: 只放规则，禁止临时文档  

### 2. project-code/ （必需）
**用途**: 项目源代码  
**内容**: backend/, frontend/, tests/, README.md  
**规则**: 具体结构按项目类型调整  

**项目类型**：
- Web应用: backend/ + frontend/
- API服务: src/ + tests/
- 命令行工具: src/ + tests/
- 数据科学: notebooks/ + data/ + models/

### 3. 项目文档/ （必需）
**用途**: 项目开发过程文档  

**子目录**：

#### 1-需求与设计/ （必需）
- 需求文档
- 架构设计
- 功能说明
- 设计文档

#### 2-开发记录/ （必需）
- 开发过程记录
- 阶段性报告
- 问题记录
- 决策记录

**内部结构**（按完整日期分类）⭐:
```
2-开发记录/
 2025-11-20/          2025年11月20日的所有记录
    2025-11-20_1400_功能开发.md
    2025-11-20_1830_测试完成.md
 2025-11-21/          2025年11月21日
 2025-11-22/          2025年11月22日
 2025-12-01/          跨月自动扩展
 README.md            索引和时间线
```

**组织原则**:
- ✅ 使用完整日期（YYYY-MM-DD）作为目录名
- ✅ 每天一个目录，符合ISO 8601标准
- ✅ 扁平清晰，无需多层嵌套

**自动分类脚本**:
```powershell
# 按日期组织开发记录
function Organize-DevelopmentRecords {
    Get-ChildItem "项目文档\2-开发记录" -File | 
        Where-Object { $_.Name -match '^(\d{4}-\d{2}-\d{2})' } | 
        ForEach-Object {
            $date = $matches[1]
            $dateDir = "项目文档\2-开发记录\$date"
            if (-not (Test-Path $dateDir)) {
                New-Item -ItemType Directory -Path $dateDir -Force | Out-Null
            }
            Move-Item $_.FullName "$dateDir\$($_.Name)"
        }
}
```

#### 3-部署运维/ （必需）
- 部署指南
- 配置说明
- 运维文档
- 环境配置

#### 4-完成度检查/ （可选）
- Schema对照
- 完成度报告
- 质量检查
- 对照验证

#### 9-归档/ （必需）
- 历史文档
- 过时内容
- 已废弃功能

### 4. 知识库/ （可选）
**用途**: 源参考资料、学习资料  
**规则**: 只读，不可修改（参考08-知识库管理规范）  

---

## 🚀 自动创建脚本

### PowerShell脚本（Windows）

```powershell
# 创建标准项目结构
function New-StandardProject {
    param(
        [string]$ProjectName = "new-project",
        [bool]$IncludeKnowledgeBase = $false,
        [bool]$IncludeCompletionCheck = $false,
        [bool]$IncludeAIChat = $false
    )
    
    # 创建根目录
    New-Item -ItemType Directory -Path $ProjectName -Force | Out-Null
    Set-Location $ProjectName
    
    # 1. 创建 .windsurf/rules/
    New-Item -ItemType Directory -Path ".windsurf\rules" -Force | Out-Null
    Write-Host "✅ 创建 .windsurf\rules\"
    
    # 2. 创建 project-code/
    New-Item -ItemType Directory -Path "project-code\backend" -Force | Out-Null
    New-Item -ItemType Directory -Path "project-code\frontend" -Force | Out-Null
    New-Item -ItemType Directory -Path "project-code\tests" -Force | Out-Null
    "# Project Code`n`n项目源代码目录" | Out-File "project-code\README.md" -Encoding UTF8
    Write-Host "✅ 创建 project-code\"
    
    # 3. 创建项目文档/（必需目录）
    $requiredDocs = @("1-需求与设计", "2-开发记录", "3-部署运维", "9-归档")
    foreach ($dir in $requiredDocs) {
        New-Item -ItemType Directory -Path "项目文档\$dir" -Force | Out-Null
        "# $dir`n" | Out-File "项目文档\$dir\README.md" -Encoding UTF8
    }
    Write-Host "✅ 创建项目文档\（必需）"
    
    # 4. 创建项目文档/（可选目录）
    if ($IncludeCompletionCheck) {
        New-Item -ItemType Directory -Path "项目文档\4-完成度检查\Schema对照" -Force | Out-Null
        New-Item -ItemType Directory -Path "项目文档\4-完成度检查\完成度报告" -Force | Out-Null
        Write-Host "✅ 创建项目文档\4-完成度检查\"
    }
    
    # 5. 创建项目文档/README.md
    $docReadme = @"
# $ProjectName - 项目文档

本目录包含项目的所有文档和记录。

## 📁 目录结构

``````
项目文档/
 1-需求与设计/        需求、架构、设计
 2-开发记录/          开发过程记录
 3-部署运维/          部署、配置、运维
 9-归档/              历史归档
``````

**创建时间**: $(Get-Date -Format "yyyy-MM-dd")
"@
    $docReadme | Out-File "项目文档\README.md" -Encoding UTF8
    
    # 6. 创建知识库/（可选）
    if ($IncludeKnowledgeBase) {
        New-Item -ItemType Directory -Path "知识库" -Force | Out-Null
        "# 知识库`n`n源参考资料（只读）" | Out-File "知识库\README.md" -Encoding UTF8
        Write-Host "✅ 创建知识库\"
    }
    
    # 7. 创建根目录文件
    # .gitignore
    $gitignore = @"
# Python
__pycache__/
*.py[cod]
*$py.class
*.so
.Python
env/
venv/
.venv

# Node
node_modules/
npm-debug.log*
yarn-debug.log*
yarn-error.log*
.pnpm-debug.log*

# IDE
.vscode/
.idea/
*.swp
*.swo
*~

# OS
.DS_Store
Thumbs.db

# Build
dist/
build/
*.egg-info/

# Temp
*.log
*.tmp
.env.local
"@
    $gitignore | Out-File ".gitignore" -Encoding UTF8
    
    # README.md
    $readme = @"
# $ProjectName

项目说明

## 📁 项目结构

``````
$ProjectName/
 .windsurf/rules/        规则系统
 project-code/           项目代码
 项目文档/               项目文档
 README.md               本文件
``````

## 🚀 快速开始

（待补充）

## 📝 文档

详细文档请查看 [项目文档/](项目文档/README.md)

**创建时间**: $(Get-Date -Format "yyyy-MM-dd")
"@
    $readme | Out-File "README.md" -Encoding UTF8
    
    Write-Host "`n✅ 标准项目结构创建完成！"
    Write-Host "项目位置: $PWD"
}

# 使用示例：
# New-StandardProject -ProjectName "my-project" -IncludeAIChat $true
```

### Bash脚本（Linux/Mac）

```bash
#!/bin/bash
# 创建标准项目结构

create_standard_project() {
    local project_name=${1:-"new-project"}
    local include_kb=${2:-false}
    local include_check=${3:-false}
    local include_ai=${4:-false}
    
    mkdir -p "$project_name"
    cd "$project_name" || exit
    
    # 1. 创建 .windsurf/rules/
    mkdir -p .windsurf/rules
    echo "✅ 创建 .windsurf/rules/"
    
    # 2. 创建 project-code/
    mkdir -p project-code/{backend,frontend,tests}
    echo "# Project Code" > project-code/README.md
    echo "✅ 创建 project-code/"
    
    # 3. 创建项目文档/（必需）
    for dir in "1-需求与设计" "2-开发记录" "3-部署运维" "9-归档"; do
        mkdir -p "项目文档/$dir"
        echo "# $dir" > "项目文档/$dir/README.md"
    done
    echo "✅ 创建项目文档/（必需）"
    
    # 4. 可选目录
    if [ "$include_check" = true ]; then
        mkdir -p "项目文档/4-完成度检查"/{Schema对照,完成度报告}
        echo "✅ 创建项目文档/4-完成度检查/"
    fi
    
    # 5. README文件
    cat > 项目文档/README.md <<EOF
# $project_name - 项目文档

创建时间: $(date +%Y-%m-%d)
EOF
    
    if [ "$include_kb" = true ]; then
        mkdir -p "知识库"
        echo "# 知识库" > "知识库/README.md"
        echo "✅ 创建知识库/"
    fi
    
    # 6. .gitignore
    cat > .gitignore <<EOF
__pycache__/
node_modules/
.vscode/
.DS_Store
*.log
.env.local
EOF
    
    # 7. 根README
    cat > README.md <<EOF
# $project_name

创建时间: $(date +%Y-%m--%d)
EOF
    
    echo ""
    echo "✅ 标准项目结构创建完成！"
}

# 使用示例：
# create_standard_project "my-project" true false true
```

---

## ✅ 创建检查清单

### 必需项（所有项目）
- [ ] .windsurf/rules/ 目录
- [ ] project-code/ 目录及子目录
- [ ] 项目文档/1-需求与设计/
- [ ] 项目文档/2-开发记录/
- [ ] 项目文档/3-部署运维/
- [ ] 项目文档/9-归档/
- [ ] 项目文档/README.md
- [ ] 根目录 README.md
- [ ] .gitignore

### 可选项（按需创建）
- [ ] 知识库/ 目录
- [ ] 项目文档/4-完成度检查/
- [ ] 项目文档/项目状态.json

---


---

## 🔄 旧项目标准化流程

### 适用场景
- 现有项目需要标准化
- 目录结构混乱需要整理
- 迁移到新的标准模板

---

### 标准化步骤

#### Step 1: 评估现有结构

**检查清单**：
```powershell
# 列出根目录所有项
Get-ChildItem -Force | Select-Object Name, Mode

# 识别代码目录
# 常见名称: src/, app/, backend/, frontend/, code/

# 识别文档目录
# 常见名称: docs/, 文档/, 项目记录/, documentation/

# 识别其他目录
# tests/, scripts/, data/, config/
```

**记录内容**：
- [ ] 代码目录名称和位置
- [ ] 文档目录名称和位置
- [ ] 测试文件位置
- [ ] 配置文件位置
- [ ] 其他重要目录

---

#### Step 2: 制定迁移计划

**目录映射**：
```
现有目录  标准目录

代码目录（src/app/code/等）  project-code/
文档目录（docs/文档/等）  项目文档/
测试目录（test/tests/等）  project-code/tests/
临时文件  项目文档/9-归档/
```

**文件分类**：
```
现有文件  标准位置

需求文档  项目文档/1-需求与设计/
开发日志  项目文档/2-开发记录/
部署文档  项目文档/3-部署运维/
对照文档  项目文档/4-完成度检查/
过时文档  项目文档/9-归档/
```

---

#### Step 3: 执行目录重命名

**PowerShell脚本**：
```powershell
# 标准化旧项目目录结构
function Standardize-ExistingProject {
    param(
        [string]$OldCodeDir = "",      # 旧代码目录名
        [string]$OldDocsDir = "",      # 旧文档目录名
        [bool]$DryRun = $true          # 预览模式
    )
    
    Write-Host "=== 旧项目标准化工具 ===" -ForegroundColor Cyan
    
    # 1. 重命名代码目录
    if ($OldCodeDir -and (Test-Path $OldCodeDir)) {
        if ($DryRun) {
            Write-Host "[预览] 将重命名: $OldCodeDir  project-code/" -ForegroundColor Yellow
        } else {
            git mv $OldCodeDir project-code
            Write-Host "✅ 已重命名: $OldCodeDir  project-code/" -ForegroundColor Green
        }
    }
    
    # 2. 重命名文档目录
    if ($OldDocsDir -and (Test-Path $OldDocsDir)) {
        if ($DryRun) {
            Write-Host "[预览] 将重命名: $OldDocsDir  项目文档/" -ForegroundColor Yellow
        } else {
            git mv $OldDocsDir 项目文档
            Write-Host "✅ 已重命名: $OldDocsDir  项目文档/" -ForegroundColor Green
        }
    }
    
    # 3. 分类文档到标准子目录
    if (Test-Path "项目文档") {
        if ($DryRun) {
            Write-Host "[预览] 将创建标准子目录" -ForegroundColor Yellow
        } else {
            $requiredDirs = @("1-需求与设计", "2-开发记录", "3-部署运维", "9-归档")
            foreach ($dir in $requiredDirs) {
                $path = "项目文档\$dir"
                if (-not (Test-Path $path)) {
                    New-Item -ItemType Directory -Path $path -Force | Out-Null
                    Write-Host "✅ 已创建: $path" -ForegroundColor Green
                }
            }
        }
    }
    
    # 4. 自动分类文件
    if (-not $DryRun -and (Test-Path "项目文档")) {
        Write-Host "`n开始自动分类文件..." -ForegroundColor Cyan
        
        Get-ChildItem "项目文档" -File | ForEach-Object {
            $file = $_
            $moved = $false
            
            # 根据文件名模式分类
            if ($file.Name -match '^\d{4}-\d{2}-\d{2}') {
                # 日期开头的记录类文档
                $dest = "项目文档\2-开发记录\$($file.Name)"
                Move-Item $file.FullName $dest
                Write-Host "   2-开发记录/: $($file.Name)" -ForegroundColor Gray
                $moved = $true
            }
            elseif ($file.Name -match '需求|设计|架构') {
                $dest = "项目文档\1-需求与设计\$($file.Name)"
                Move-Item $file.FullName $dest
                Write-Host "   1-需求与设计/: $($file.Name)" -ForegroundColor Gray
                $moved = $true
            }
            elseif ($file.Name -match '部署|配置|运维') {
                $dest = "项目文档\3-部署运维\$($file.Name)"
                Move-Item $file.FullName $dest
                Write-Host "   3-部署运维/: $($file.Name)" -ForegroundColor Gray
                $moved = $true
            }
            elseif ($file.Name -match '对照|完成度|检查') {
                # 如果不存在，创建可选目录
                if (-not (Test-Path "项目文档\4-完成度检查")) {
                    New-Item -ItemType Directory -Path "项目文档\4-完成度检查" -Force | Out-Null
                }
                $dest = "项目文档\4-完成度检查\$($file.Name)"
                Move-Item $file.FullName $dest
                Write-Host "   4-完成度检查/: $($file.Name)" -ForegroundColor Gray
                $moved = $true
            }
            
            # 未匹配的放到归档
            if (-not $moved -and $file.Name -ne "README.md" -and $file.Name -ne "项目状态.json") {
                $dest = "项目文档\9-归档\$($file.Name)"
                Move-Item $file.FullName $dest
                Write-Host "   9-归档/: $($file.Name)" -ForegroundColor Gray
            }
        }
    }
    
    if ($DryRun) {
        Write-Host "`n=== 这是预览模式，没有实际执行 ===" -ForegroundColor Yellow
        Write-Host "运行时设置 -DryRun `$false 来实际执行" -ForegroundColor Yellow
    } else {
        Write-Host "`n✅ 标准化完成！" -ForegroundColor Green
    }
}

# 使用示例：
# 1. 预览模式（不执行，只显示将要做什么）
# Standardize-ExistingProject -OldCodeDir "src" -OldDocsDir "docs" -DryRun $true

# 2. 实际执行
# Standardize-ExistingProject -OldCodeDir "src" -OldDocsDir "docs" -DryRun $false
```

---

#### Step 4: 批量更新引用

**自动更新脚本**：
```powershell
# 批量更新所有文件中的路径引用
function Update-ProjectReferences {
    param(
        [string]$OldCodePath = "",
        [string]$NewCodePath = "project-code",
        [string]$OldDocsPath = "",
        [string]$NewDocsPath = "项目文档"
    )
    
    Write-Host "=== 批量更新路径引用 ===" -ForegroundColor Cyan
    
    # 创建替换映射
    $replacements = @{}
    if ($OldCodePath) {
        $replacements[$OldCodePath] = $NewCodePath
    }
    if ($OldDocsPath) {
        $replacements[$OldDocsPath] = $NewDocsPath
    }
    
    # 扫描所有Markdown文件
    $files = Get-ChildItem -Path "." -Filter "*.md" -Recurse -Exclude node_modules,venv,__pycache__ | 
        Where-Object { $_.FullName -notmatch 'node_modules|venv|__pycache__' }
    
    $updatedCount = 0
    
    foreach ($file in $files) {
        $content = Get-Content $file.FullName -Raw -Encoding UTF8 -ErrorAction SilentlyContinue
        if ($content) {
            $updated = $false
            
            foreach ($old in $replacements.Keys) {
                if ($content -match [regex]::Escape($old)) {
                    $content = $content -replace [regex]::Escape($old), $replacements[$old]
                    $updated = $true
                }
            }
            
            if ($updated) {
                [System.IO.File]::WriteAllText($file.FullName, $content, [System.Text.UTF8Encoding]::new($false))
                $updatedCount++
                Write-Host "  ✅ $($file.Name)" -ForegroundColor Green
            }
        }
    }
    
    Write-Host "`n✅ 已更新 $updatedCount 个文件的引用" -ForegroundColor Green
}

# 使用示例：
# Update-ProjectReferences -OldCodePath "src" -OldDocsPath "docs"
```

---

#### Step 5: 更新README和目录树

**自动更新README**：
```powershell
# 更新README.md中的目录树
function Update-ReadmeTree {
    param(
        [string]$ReadmePath = "README.md"
    )
    
    if (-not (Test-Path $ReadmePath)) {
        Write-Host "README.md 不存在" -ForegroundColor Red
        return
    }
    
    Write-Host "=== 更新README目录树 ===" -ForegroundColor Cyan
    
    # 生成新的目录树
    $tree = @"
``````
项目结构/
 .windsurf/rules/        规则系统
 project-code/           项目代码
    backend/
    frontend/
    tests/
 项目文档/               项目文档
    1-需求与设计/
    2-开发记录/
    3-部署运维/
    9-归档/
 .gitignore
 README.md
``````
"@
    
    # 读取README内容
    $content = Get-Content $ReadmePath -Raw -Encoding UTF8
    
    # 查找并替换旧的目录树（在```之间的内容）
    if ($content -match '(?s)```[^`]*项目.*?```') {
        $content = $content -replace '(?s)```[^`]*项目.*?```', $tree
        [System.IO.File]::WriteAllText($ReadmePath, $content, [System.Text.UTF8Encoding]::new($false))
        Write-Host "✅ 已更新 $ReadmePath 中的目录树" -ForegroundColor Green
    } else {
        Write-Host "⚠️ 未找到目录树，请手动添加" -ForegroundColor Yellow
    }
}

# 使用示例：
# Update-ReadmeTree
# Update-ReadmeTree -ReadmePath "项目文档\README.md"
```

---

#### Step 6: 验证和提交

**验证清单**：
```powershell
# 标准化验证
function Test-Standardization {
    Write-Host "=== 标准化验证 ===" -ForegroundColor Cyan
    
    $issues = @()
    
    # 1. 检查必需目录
    $requiredDirs = @(
        ".windsurf\rules",
        "project-code",
        "项目文档",
        "项目文档\1-需求与设计",
        "项目文档\2-开发记录",
        "项目文档\3-部署运维",
        "项目文档\9-归档"
    )
    
    foreach ($dir in $requiredDirs) {
        if (Test-Path $dir) {
            Write-Host "  ✅ $dir" -ForegroundColor Green
        } else {
            Write-Host "  ❌ $dir (缺失)" -ForegroundColor Red
            $issues += "缺失必需目录: $dir"
        }
    }
    
    # 2. 检查必需文件
    $requiredFiles = @(
        "README.md",
        ".gitignore",
        "项目文档\README.md"
    )
    
    foreach ($file in $requiredFiles) {
        if (Test-Path $file) {
            Write-Host "  ✅ $file" -ForegroundColor Green
        } else {
            Write-Host "  ❌ $file (缺失)" -ForegroundColor Red
            $issues += "缺失必需文件: $file"
        }
    }
    
    # 3. 检查项目文档根目录是否有文件（除了README和状态文件）
    if (Test-Path "项目文档") {
        $rootFiles = Get-ChildItem "项目文档" -File | 
            Where-Object { $_.Name -ne "README.md" -and $_.Name -ne "项目状态.json" }
        
        if ($rootFiles.Count -gt 0) {
            Write-Host "  ⚠️ 项目文档根目录有 $($rootFiles.Count) 个文件需要分类" -ForegroundColor Yellow
            $rootFiles | ForEach-Object {
                Write-Host "     - $($_.Name)" -ForegroundColor Gray
            }
            $issues += "项目文档根目录有未分类文件"
        }
    }
    
    # 4. 报告结果
    Write-Host ""
    if ($issues.Count -eq 0) {
        Write-Host "✅ 标准化验证通过！" -ForegroundColor Green
        return $true
    } else {
        Write-Host "❌ 发现 $($issues.Count) 个问题：" -ForegroundColor Red
        $issues | ForEach-Object { Write-Host "  - $_" -ForegroundColor Red }
        return $false
    }
}

# 使用示例：
# Test-Standardization
```

**Git提交**：
```powershell
# 提交标准化更改
git add -A
git status

# 提交
git commit -m "refactor: 项目标准化

- 重命名代码目录为 project-code/
- 重组文档目录为 项目文档/
- 按标准分类所有文档
- 更新所有路径引用
- 更新README和目录树"
```

---

### 完整标准化流程示例

```powershell
# 旧项目标准化完整流程
function Complete-Standardization {
    param(
        [string]$OldCodeDir = "src",
        [string]$OldDocsDir = "docs"
    )
    
    Write-Host "===开始旧项目标准化 ===" -ForegroundColor Cyan
    Write-Host ""
    
    # 1. 预览
    Write-Host "步骤 1/6: 预览更改" -ForegroundColor Yellow
    Standardize-ExistingProject -OldCodeDir $OldCodeDir -OldDocsDir $OldDocsDir -DryRun $true
    
    Read-Host "`n按Enter继续执行实际更改，或Ctrl+C取消"
    
    # 2. 执行标准化
    Write-Host "`n步骤 2/6: 执行目录重命名" -ForegroundColor Yellow
    Standardize-ExistingProject -OldCodeDir $OldCodeDir -OldDocsDir $OldDocsDir -DryRun $false
    
    # 3. 更新引用
    Write-Host "`n步骤 3/6: 更新路径引用" -ForegroundColor Yellow
    Update-ProjectReferences -OldCodePath $OldCodeDir -OldDocsPath $OldDocsDir
    
    # 4. 更新README
    Write-Host "`n步骤 4/6: 更新README" -ForegroundColor Yellow
    Update-ReadmeTree
    Update-ReadmeTree -ReadmePath "项目文档\README.md"
    
    # 5. 验证
    Write-Host "`n步骤 5/6: 验证标准化" -ForegroundColor Yellow
    $valid = Test-Standardization
    
    # 6. 提交
    if ($valid) {
        Write-Host "`n步骤 6/6: 提交更改" -ForegroundColor Yellow
        git add -A
        git commit -m "refactor: 项目标准化`n`n- 重命名 $OldCodeDir  project-code/`n- 重组 $OldDocsDir  项目文档/`n- 按标准分类所有文档`n- 更新所有路径引用`n- 更新README和目录树"
        Write-Host "`n✅ 标准化完成并已提交！" -ForegroundColor Green
    } else {
        Write-Host "`n⚠️ 请修复问题后再提交" -ForegroundColor Yellow
    }
}

# 使用：
# Complete-Standardization -OldCodeDir "src" -OldDocsDir "docs"
```

---

### 注意事项

1. **备份重要** ⚠️
   - 标准化前先提交当前状态
   - 确保可以回滚

2. **使用预览模式**
   - 先用 `-DryRun $true` 预览
   - 确认无误后再实际执行

3. **手动检查**
   - 自动分类可能不完美
   - 重要文件手动确认

4. **分步执行**
   - 可以分步骤执行
   - 每步验证后再继续

5. **更新引用**
   - 必须更新所有路径引用
   - 包括README、文档、配置文件

6. **遵循规则**
   - 参考 04-变更同步规则
   - 参考 05-README管理规范
## 🎯 AI行为规则

### 创建新项目时

1. **确认项目类型**
   - Web应用
   - API服务
   - 命令行工具
   - 数据科学项目

2. **执行创建脚本**
   - 使用上述PowerShell或Bash脚本
   - 根据项目类型调整 project-code/ 结构

3. **确认可选目录**
   - 是否需要知识库？
   - 是否需要完成度检查？

4. **完成初始化**
   - 创建必需的README文件
   - 初始化Git仓库
   - 复制规则系统

### 组织现有项目时

1. **评估当前结构**
   - 识别代码目录
   - 识别文档位置
   - 识别特殊需求

2. **逐步迁移**
   - 重命名代码目录为 project-code/
   - 组织项目文档到标准结构
   - 创建缺失的必需目录

3. **更新引用**
   - 批量更新路径引用
   - 更新README文档
   - 保持Git历史

---

## 📝 项目类型适配

### Web应用项目

```
project-code/
 backend/
    src/
    tests/
    requirements.txt
 frontend/
    src/
    public/
    package.json
 README.md
```

### API服务项目

```
project-code/
 src/
    routes/
    models/
    controllers/
    middleware/
 tests/
 README.md
```

### 命令行工具

```
project-code/
 src/
    main程序文件
 tests/
 README.md
 setup.py 或 package.json
```

### 数据科学项目

```
project-code/
 notebooks/
 data/
    raw/
    processed/
 models/
 src/
 README.md
```

---

## 🔍 目录层级控制

### 最大层级限制
- **根目录**: 最多5层嵌套
- **project-code/**: 根据项目需要，但建议5层
- **项目文档/**: 最多3层

### 检查命令
```powershell
# PowerShell
Get-ChildItem -Recurse -Directory | ForEach-Object { 
    $depth = ($_.FullName -split '\\').Count 
    if ($depth > 5) { Write-Host "⚠️ 层级过深: $($_.FullName)" }
}
```

```bash
# Bash
find . -type d | awk -F'/' '{if(NF>6) print "⚠️ 层级过深:", $0}'
```

---

## ✅ 规则符合性

### 关联规则
- **00-核心工作原则**: 严格目录控制
- **01-文件操作规范**: 文件位置规范
- **02-目录管理规范**: 目录创建规范
- **03-文件命名规范**: 命名标准
- **04-变更同步规则**: 文档同步
- **05-README管理规范**: README维护
- **08-知识库管理规范**: 知识库只读

---

## 💡 最佳实践

### 1. 复用规则
- 将此规则文件复制到新项目
- 使用创建脚本快速初始化
- 保持所有项目结构一致

### 2. 适配调整
- project-code/ 内部结构根据项目类型调整
- 可选目录按需创建
- 保持核心结构不变

### 3. 文档维护
- 及时更新项目文档/README.md
- 保持目录树与实际一致
- 定期归档过时内容

### 4. 团队协作
- 统一使用标准模板
- 降低理解成本
- 便于项目交接

---

**此规则可直接复制到任何新项目！** 🎯

**使用创建脚本一键生成标准目录结构！** 🚀
