---
title: "File Operations"
description: "文件操作强制规则"
trigger: always
---

# 文件操作强制规则

**规则类型**: 通用规则 �? 
**强制级别**: 🔴 严格执行  
**适用场景**: 所有文件创建、移动、删除操�? 
**版本**: v1.0.0  

---

## 📋 目录

- [核心原则](#核心原则)
- [创建文件前的5步强制检查](#创建文件前的5步强制检�?
- [严格禁止的操作](#严格禁止的操�?
- [文件位置判断流程](#文件位置判断流程)
- [操作示例](#操作示例)
- [违规处理机制](#违规处理机制)

---

## 🎯 核心原则

### 三大核心原则

1. **先查后建** - 创建前必须搜索，避免重复
2. **明确位置** - 文件必须放在正确的目�?
3. **规范命名** - 文件名必须清晰、具体、符合规�?

### 适用范围

此规则适用于：
- �?创建任何新文件（代码、文档、配置等�?
- �?移动现有文件到新位置
- �?重命名现有文�?
- �?复制文件到新位置
- �?删除文件前的验证

---

## 🔍 创建文件前的5步强制检�?

### 步骤1: 搜索是否已存在类似文�?

**目的**: 避免重复创建，避免文件混�?

**必须执行的搜�?*:

```bash
# 方法1: 搜索文件内容
grep -r "关键�? [目录]/

# 方法2: 搜索文件�?
find [目录]/ -name "*关键�?.md"

# 方法3: 列出目录内容
ls [目录]/
```

**必须回答的问�?*:
- [ ] 是否有相同功能的文件�?
- [ ] 是否有类似主题的文件�?
- [ ] 新内容是否可以补充到现有文件�?
- [ ] 如果已存在，为什么还要创建新文件�?

**决策逻辑**:
```
如果找到类似文件�?
  ├─ 内容相同 �?�?不创建，使用现有文件
  ├─ 内容互补 �?⚠️ 补充到现有文件，不新�?
  ├─ 内容重叠 �?⚠️ 合并到现有文�?
  └─ 完全不同 �?�?可以创建新文�?

如果未找到类似文件：
  └─ �?继续下一步检�?
```

---

### 步骤2: 确定正确的目录位�?

**目的**: 确保文件放在正确的位置，保持项目结构清晰

**必须回答的问�?*:
- [ ] 这是文档还是代码�?
- [ ] 应该放在哪个主目录？（文档目�?vs 代码目录�?
- [ ] 应该放在哪个子目录？
- [ ] 完整的绝对路径是什么？

**判断流程**:

参�?`project-config.md` 中定义的目录结构，使用以下流程判断：

```
文件类型判断�?
�?
├─ 代码文件 (.py, .ts, .tsx, .js, .java, .cpp)
�? └─ 放在代码主目录下
�?    ├─ 后端代码 �?[后端目录]/
�?    ├─ 前端代码 �?[前端目录]/
�?    ├─ 测试代码 �?tests/
�?    └─ 脚本 �?scripts/
�?
├─ 文档文件 (.md, .txt, .rst)
�? ├─ 技术文�?�?代码目录下的 README.md �?docs/
�? └─ 项目文档 �?文档主目录下的分类目�?
�?    （参�?project-config.md 的分类定义）
�?
├─ 配置文件 (.json, .yaml, .toml, .ini, .env)
�? ├─ 项目级配�?�?项目根目�?
�? ├─ 代码配置 �?代码目录
�? └─ 状态文�?�?文档目录（如适用�?
�?
├─ 数据文件 (.json, .csv, .xlsx, .sqlite)
�? ├─ 示例数据 �?代码目录/data/
�? └─ 文档数据 �?不提交到Git�?gitignore�?
�?
└─ 临时文件 (.tmp, .temp, .bak)
   └─ ⚠️ 添加�?.gitignore，不提交
```

**禁止的位�?*:
- �?项目根目录（除了明确允许的文件）
- �?文档主目录的根目录（必须放在分类子目录）
- �?随意创建新的顶层目录

---

### 步骤3: 确认文件名符合规�?

**目的**: 文件名清晰、统一、易于理�?

**命名规范** (参�?`03-naming-convention.md`):

**文档类型**:
- **规范�?*: `[主题]规范.md`
  - 示例: `文件操作规范.md`, `API设计规范.md`
  
- **说明�?*: `[主题]说明.md`
  - 示例: `部署说明.md`, `配置说明.md`
  
- **指南�?*: `[主题]指南.md`
  - 示例: `新手指南.md`, `开发指�?md`
  
- **记录�?*: `YYYY-MM-DD_[描述].md`
  - 示例: `2025-11-25_功能开发记�?md`
  
- **报告�?*: `YYYY-MM-DD_[主题]报告.md`
  - 示例: `2025-11-25_测试报告.md`

**代码类型**:
- 遵循项目语言的命名规�?
- Python: `snake_case.py`
- TypeScript: `PascalCase.tsx` (组件), `camelCase.ts` (工具)
- Java: `PascalCase.java`

**必须回答的问�?*:
- [ ] 文件名是否清晰具体？
- [ ] 是否避免了禁止的关键词？
- [ ] 是否会与现有文件混淆�?
- [ ] 是否符合命名类型规范�?

**禁止的文件名**:
- �?模糊名称: `文档.md`, `说明.md`, `笔记.md`, `README2.md`
- �?临时名称: `临时.md`, `test.md`, `新建文档.md`, `TODO.md`
- �?包含空格: `我的 文档.md`, `项目 说明.md`
- �?随意命名: `aaa.md`, `xxx.py`, `temp123.js`
- �?中英混杂: `项目setup.md`, `配置config.md`（除非有明确原因�?

**允许的文件名**:
- �?清晰具体: `用户认证功能说明.md`, `数据库设计规�?md`
- �?符合类型: `2025-11-25_版本发布记录.md`
- �?标准名称: `README.md`, `.gitignore`, `package.json`

---

### 步骤4: 检查是否需要创建新目录

**目的**: 避免随意创建目录，保持项目结构稳�?

**如果目录不存在，必须确认**:
- [ ] 这个新目录是否真的必要？
- [ ] 是否符合项目的目录分类规范？
- [ ] 是否应该放在现有目录的子目录下？
- [ ] 目录名称是否清晰明确�?

**允许创建新目录的情况**:
- �?项目配置中明确定义的目录结构
- �?代码按模块划分的子目录（�?`components/`, `services/`�?
- �?文档按主题划分的子目录（但必须在分类目录下）

**禁止创建的目�?*:
- �?在项目根目录创建新的顶层目录
- �?在文档主目录根目录创建不在分类中的目�?
- �?创建临时目录（除非添加到 .gitignore�?
- �?创建深层嵌套目录�?4层）

**目录命名规范**:
- 使用清晰的英文或中文名称
- 可以使用编号前缀（如 `1-`, `2-`�?
- 避免空格和特殊字�?
- 小写字母和连字符（代码目录）或中文（文档目录�?

---

### 步骤5: 准备更新项目索引

**目的**: 保持项目文档的可发现性和一致�?

**创建文件后必须更�?*:

1. **在文档目录创建文�?*:
   - 更新 `[文档目录]/README.md` 的索引部�?
   - 添加到对应分类的文件列表
   - 添加简短描�?

2. **创建重要代码文件**:
   - 更新对应目录�?README.md
   - 如果是新功能/模块，添加说�?
   - 更新项目状态文件（如适用�?

3. **创建新的子目�?*:
   - 在父目录�?README.md 中添加目录说�?
   - 在新目录中创�?README.md
   - 说明目录用途和内容

4. **修改文件引用**:
   - 如果移动或重命名文件，更新所有引�?
   - 检�?Markdown 链接
   - 检查代码中�?import 路径

**必须回答的问�?*:
- [ ] 需要更新哪�?README.md�?
- [ ] 文件应该添加到索引的哪个部分�?
- [ ] 是否需要添加描述或说明�?
- [ ] 是否有其他文件引用需要更新？

---

## 🚫 严格禁止的操�?

### 绝对不允许的操作

#### 1. �?跳过检查直接创建文�?

**禁止**:
```
# 错误示例：直接创建，未检�?
write_to_file("新建文档.md", content)
```

**必须**:
```
# 正确流程�?
1. 搜索是否已存�?
2. 确定目录位置
3. 确认文件�?
4. 检查目�?
5. 准备更新索引
6. 创建文件
7. 更新索引
```

#### 2. �?在禁止的位置创建文件

**禁止的位�?*（根�?`project-config.md` 定义�?
- 项目根目录（除了明确允许的文件）
- 文档主目录的根目�?
- 任何标记�?只读"�?自动生成"的目�?
- 🔒 **知识库目�?* - 只允许添加新文件，不允许修改、删除已有文�?

**示例**:
```
�?错误：在根目录创建文�?
/项目根目�?功能说明.md

�?正确：放在文档目录的分类子目�?
/项目根目�?[文档目录]/[分类目录]/功能说明.md
```

#### 3. �?使用禁止的文件名

**禁止**:
- 模糊名称
- 临时名称
- 包含空格
- 随意命名

**示例**:
```
�?错误文件名：
- 文档.md
- 临时笔记.md
- test123.py
- 我的 项目.md

�?正确文件名：
- 用户认证功能说明.md
- 2025-11-25_开发记�?md
- user_service.py
- 项目部署指南.md
```

#### 4. �?创建文件后不更新索引

**禁止**:
```
创建文件 �?完成 �?
```

**必须**:
```
创建文件 �?更新 README.md �?完成 �?
```

#### 5. �?随意创建目录

**禁止**:
```
# 在根目录随意创建
/项目根目�?临时文件�?
/项目根目�?我的笔记/
```

**必须**:
```
# 遵循项目配置的目录结�?
参�?project-config.md 中定义的目录
```

---

## 🗺�?文件位置判断流程

### 完整的判断流程图

```
开始：需要创建一个文�?
�?
├─ 问题1: 这是什么类型的文件�?
�? �?
�? ├─ 代码文件 (.py, .ts, .js �?
�? �? └─ 问题1.1: 是什么代码？
�? �?    ├─ 后端代码 �?[后端目录]/[模块]/
�? �?    ├─ 前端代码 �?[前端目录]/src/[模块]/
�? �?    ├─ 测试代码 �?tests/
�? �?    ├─ 工具脚本 �?scripts/
�? �?    └─ 配置文件 �?对应代码目录
�? �?
�? ├─ 文档文件 (.md, .txt �?
�? �? └─ 问题1.2: 是什么类型的文档�?
�? �?    ├─ 技术文�?�?代码目录/README.md �?docs/
�? �?    ├─ 参考资�?源文�?�?知识�? 🔒 只读参�?
�? �?    └─ 项目文档 �?[文档目录]/[分类]/
�? �?       �?
�? �?       └─ 问题1.2.1: 属于哪个分类�?
�? �?          ├─ 归档文档 �?[分类1]/
�? �?          ├─ 参考资�?�?[分类2]/
�? �?          ├─ 功能说明 �?[分类3]/
�? �?          ├─ 部署运维 �?[分类4]/
�? �?          ├─ 问题分析 �?[分类5]/
�? �?          ├─ 开发规�?�?[分类6]/
�? �?          ├─ 过程记录 �?[分类7]/
�? �?          └─ 其他分类 �?[对应分类]/
�? �?
�? ├─ 配置文件 (.json, .yaml, .env �?
�? �? └─ 问题1.3: 是什么配置？
�? �?    ├─ 项目级配�?�?项目根目�?
�? �?    ├─ 后端配置 �?[后端目录]/
�? �?    ├─ 前端配置 �?[前端目录]/
�? �?    └─ 状态文�?�?[文档目录]/ (如适用)
�? �?
�? └─ 临时文件 (.tmp, .temp, .log �?
�?    └─ ⚠️ 添加�?.gitignore，不提交
�?
├─ 问题2: 是否是特殊文件？
�? ├─ README.md �?对应目录的说明文�?
�? ├─ .gitignore �?项目根目�?
�? └─ LICENSE �?项目根目�?
�?
└─ 最终确�?
   ├─ 路径正确�?�?�?
   ├─ 名称规范�?�?�?
   ├─ 已搜索？ �?�?
   └─ 准备索引�?�?�?
   
   �?创建文件 �?
```

---

## 📝 操作示例

### 正确示例

#### 示例1: 创建功能说明文档

```
场景: 需要创建一个用户认证功能的说明文档

步骤1: 搜索
grep -r "用户认证" [文档目录]/
�?未找到类似文�?�?

步骤2: 确定位置
这是功能说明文档 �?[文档目录]/[功能说明分类]/

步骤3: 确认文件�?
使用"说明�?命名 �?用户认证功能说明.md �?

步骤4: 检查目�?
[功能说明分类]/ 目录已存�?�?

步骤5: 准备索引
需要更�?[文档目录]/README.md �?

执行:
创建文件: [文档目录]/[功能说明分类]/用户认证功能说明.md
更新索引: [文档目录]/README.md

结果: �?正确
```

#### 示例2: 创建开发记�?

```
场景: 需要记录今天的开发过�?

步骤1: 搜索
ls [文档目录]/[过程记录分类]/
�?没有今天的记�?�?

步骤2: 确定位置
这是过程记录 �?[文档目录]/[过程记录分类]/

步骤3: 确认文件�?
使用"记录�?命名 �?2025-11-25_功能开发记�?md �?

步骤4: 检查目�?
[过程记录分类]/ 目录已存�?�?

步骤5: 准备索引
需要更�?[文档目录]/README.md �?

执行:
创建文件: [文档目录]/[过程记录分类]/2025-11-25_功能开发记�?md
更新索引: [文档目录]/README.md

结果: �?正确
```

### 错误示例

#### 错误示例1: 跳过检�?

```
场景: 直接在根目录创建文档

�?错误操作:
创建文件: /项目根目�?说明.md

问题:
1. 未搜索是否已存在 �?
2. 在根目录创建文档 �?
3. 文件名模�?�?
4. 未更新索�?�?

正确操作:
应该创建�? [文档目录]/[合适分类]/[具体名称]说明.md
```

#### 错误示例2: 文件名不规范

```
场景: 创建临时文档

�?错误操作:
创建文件: [文档目录]/临时笔记.md

问题:
1. 文件名包�?临时" �?
2. 不在过程记录目录 �?
3. 未指定日�?�?

正确操作:
如果是临时笔记，应该创建�?
[文档目录]/[过程记录分类]/2025-11-25_临时开发笔�?md
```

#### 错误示例3: 位置错误

```
场景: 在错误的目录创建文件

�?错误操作:
创建文件: [文档目录]/功能说明.md

问题:
1. 在文档主目录根目录创�?�?
2. 未放在分类子目录 �?

正确操作:
应该创建�? [文档目录]/[功能说明分类]/功能说明.md
```

---

## ⚠️ 违规处理机制

### 检测到违规时的处理流程

```
检测到文件操作违规
�?
├─ 立即停止操作 🛑
�?
├─ 说明违反的规�?
�? ├─ 指出具体违反了哪一条规�?
�? ├─ 说明为什么这样操作是错误�?
�? └─ 引用相关规则文档
�?
├─ 提供正确的操作方�?
�? ├─ 说明正确的文件位�?
�? ├─ 建议正确的文件名
�? └─ 提供完整的操作流�?
�?
└─ 等待用户确认
   └─ 用户同意后，按正确方法执�?
```

### 示例对话

```
用户: "请在项目根目录创建一个功能说�?md"

AI: "抱歉，我不能执行这个操作�?

违规原因:
1. 违反�?文件位置规则' - 不能在项目根目录创建文档文件
2. 违反�?文件命名规则' - '功能说明.md' 太模�?

正确的操作应该是:
1. 确定具体是什么功能的说明
2. 创建�? [文档目录]/[功能说明分类]/[具体功能名]功能说明.md
3. 更新 [文档目录]/README.md 索引

例如:
- 用户认证功能说明.md
- 数据导入功能说明.md

请确认具体是什么功能，我会在正确的位置创建文件�?
```

---

## 🔒 知识库特殊规�?�?

### 知识库目录的只读属�?

**目录**: `知识�?`  
**用�?*: 存放源参考文件、技术文档、学习资料等只读参考资�? 
**重要�?*: 所有项目标配目�?

### 允许的操�?�?

1. **读取文件**
   ```
   �?允许: 阅读知识库中的任何文�?
   �?允许: 引用和参考知识库内容
   �?允许: 在其他文档中链接到知识库文件
   ```

2. **添加新文�?*
   ```
   �?允许: 添加新的参考资料到知识�?
   �?允许: 创建新的子目录和文档
   �?允许: 从外部复制文件到知识�?
   ```

### 严格禁止的操�?�?

1. **修改已有文件**
   ```
   �?禁止: 修改知识库中已有文件的内�?
   �?禁止: 更新、编辑任何现有文�?
   ```

2. **删除文件**
   ```
   �?禁止: 删除知识库中的任何文�?
   �?禁止: 清理、归档知识库内容
   ```

3. **移动或重命名**
   ```
   �?禁止: 重命名知识库中的文件
   �?禁止: 移动知识库中的文件位�?
   �?禁止: 重组知识库目录结�?
   ```

### 为什么只读？

**原因**:
- 📌 **保持参考基�?* - 知识库是参考标准，修改会导致参考失�?
- 🔍 **可追溯�?* - 保持源文件的完整性，便于对照和溯�?
- 📚 **知识积累** - 避免丢失重要的参考资料和历史信息
- �?**最佳实�?* - 如需修改，应在项目代码目录中创建新文�?

### 正确使用流程

**示例场景**: 参考源项目实现新功�?

```
�?正确流程:
1. 阅读 知识�?owlRD/backend/api/users.py
2. 理解其中的用户API实现方式
3. �?[项目代码目录]/api/ 中创建新的用户API文件
4. �?[文档目录]/2-源参考对�? 中记录参考关系和差异

�?错误做法:
1. 直接修改 知识�?owlRD/backend/api/users.py �?
2. 删除不需要的参考文�?�?
3. 重命名知识库中的文件以便理解 �?
```

### 知识库操作检查清�?

**在知识库目录操作前，确认**:
- [ ] 这个操作是否是读�?引用�?�?�?允许
- [ ] 这个操作是否是添加新文件�?�?�?允许
- [ ] 这个操作是否会修改已有文件？ �?�?禁止
- [ ] 这个操作是否会删除文件？ �?�?禁止
- [ ] 这个操作是否会重命名/移动�?�?�?禁止

**如果需要修改参考内�?*:
```
不要修改知识库！
�?在项目代码目录中创建新文�?
�?在文档中记录与源参考的差异
�?保持知识库的原始状�?
```

---

## �?检查清单总结

### 每次创建文件前，确保完成�?

- [ ] �?**步骤1**: 搜索了是否已存在类似文件
- [ ] �?**步骤2**: 确定了正确的目录位置（参�?project-config.md�?
- [ ] �?**步骤3**: 文件名符合命名规范（参�?03-naming-convention.md�?
- [ ] �?**步骤4**: 检查了目录是否存在，不随意创建新目�?
- [ ] �?**步骤5**: 准备好更新项目索引（README.md�?

### 创建文件后，确保完成�?

- [ ] �?更新了相关的 README.md 索引
- [ ] �?更新了文件引用（如果是移�?重命名）
- [ ] �?验证了文件在正确的位�?
- [ ] �?文件名清晰易�?

---

**规则维护**: AI开发规范系�? 
**最后更�?*: 2025-11-26  
**规则版本**: v1.0.0  
**适用项目**: 所有软件开发项�?
