---
trigger: always_on
description: "修改后必须同步文档和索引"
---

# 变更同步规则

**规则类型**: 🔴 强制规则  
**强制级别**: 🔴 严格执行

---

## 核心原则

### 变更必须同步

```
代码变更  文档同步  索引更新
```

**核心理念**:
- 💡 文档是代码的一部分 - 修改代码=修改文档
- 🔗 保持一致性 - 任何变更都要保持系统一致
- ✅ 完整性检查 - 确保所有相关内容已更新

---

## 适用场景

| 操作类型 | 需要同步 | 原因 |
|---------|---------|------|
| ✏️ 修改文件内容 | ✅ 必须 | 功能改变需要更新文档 |
| ❌ 删除文件 | ✅ 必须 | 索引需要移除 |
| 📝 重命名文件 | ✅ 必须 | 所有引用需要更新 |
| 📦 移动文件 | ✅ 必须 | 路径变更需要同步 |
| �� 添加新功能 | ✅ 必须 | README需要说明 |
| 🐛 修Bug | ⚠️ 视情况 | 如影响使用需更新 |
| ♻️ 重构代码 | ⚠️ 视情况 | 如API改变需更新 |
| 💅 样式调整 | ❌ 通常不需要 | 不影响功能 |

---

## 修改文件后的同步要求

### 1. 更新README.md
- 如果添加新功能，在README中说明
- 如果修改现有功能，更新相关章节
- 保持README与实际功能一致

### 2. 更新索引文件
- `项目文档/文档索引.md` - 如有新文档
- `.windsurf/README.md` - 如修改规则

**何时更新 .windsurf/README.md**：
- ✅ 新增规则文件
- ✅ 删除规则文件
- ✅ 重命名规则文件
- ✅ 修改规则的激活模式（frontmatter）
- ✅ 规则文件编号变化

**内容**：
- 规则总数
- 规则列表
- 版本号
- 最后更新日期
- 相关目录的README - 如修改目录结构

### 3. 更新引用
- 检查其他文档是否引用该文件
- 更新所有相关链接
- 确保没有死链接

---

## 删除文件后的同步要求

### 必须更新
1. ✅ 从所有索引中移除
2. ✅ 删除所有指向该文件的链接
3. ✅ 更新相关README
4. ✅ 检查依赖关系

### 检查清单
- [ ] README.md中移除说明
- [ ] 索引文件中移除条目
- [ ] 其他文档中移除引用
- [ ] 目录结构图更新

---

## 重命名文件后的同步要求

### 必须更新
1. ✅ 所有文档中的引用
2. ✅ 索引文件中的名称
3. ✅ README中的链接
4. ✅ Git历史保持连贯（使用git mv）

### 查找引用
```bash
# 在所有Markdown文件中查找旧文件名
grep -r "旧文件名" *.md
```

---

## 检查清单

操作后必须检查：
1. [ ] README.md已更新
2. [ ] 相关索引已更新
3. [ ] 所有引用已修正
4. [ ] 没有死链接
5. [ ] 目录结构图正确
6. [ ] Git提交包含所有变更

---

## 严格禁止

### ❌ 绝对禁止的行为
1. **修改代码但不更新文档**
   - 导致文档与实际不符
   - 其他开发者会误解

2. **删除文件但不更新索引**
   - 造成死链接
   - README指向不存在的文件

3. **重命名但不更新引用**
   - 所有引用失效
   - 系统完整性破坏

4. **只更新部分文档**
   - 不一致性
   - 信息混乱

---

## AI自检要求

每次文件操作后，AI必须：
1. ✅ 自动检查是否需要同步
2. ✅ 列出需要更新的所有文档
3. ✅ 执行所有必要的同步操作
4. ✅ 验证同步完成

**AI不应该等待提醒，而应该主动执行同步！**

---

**保持同步是保持系统整洁和可维护性的关键！** 🎯