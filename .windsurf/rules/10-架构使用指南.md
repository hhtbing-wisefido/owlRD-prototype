---
title: "架构使用指南"
description: "架构模板的使用说明"
trigger: manual
---

# 📐 架构模板使用指南

**版本**: v1.0.0  
**创建日期**: 2025-11-26  
**适用场景**: 新建项目（全�?后端/前端等各种类型）

---

## 🎯 快速开�?

### 方法1: 使用初始化脚本（推荐）⭐

```bash
# 1. 进入工作目录
cd D:\Projects

# 2. 运行初始化脚�?
python path\to\.windsurf\scripts\init_project_from_template.py MyNewProject

# 3. 查看生成的项�?
cd MyNewProject
```

**脚本会自动创�?*:
- �?完整的目录结�?
- �?核心配置文件（app.py, requirements.txt等）
- �?基础测试框架
- �?数据验证脚本
- �?README文档

---

### 方法2: 手动创建

#### 步骤1: 创建项目目录

```bash
mkdir MyNewProject
cd MyNewProject
```

#### 步骤2: 复制规则系统

```bash
# 从现有项目复�?
xcopy D:\path\to\.windsurf .windsurf\ /E /I

# 验证复制成功
dir .windsurf
```

#### 步骤3: 参考架构模板创建目�?

查看 `.windsurf/06-directory-architecture-template.md`，按照模板创建目录：

```bash
# 核心目录
mkdir data schema spec scripts tests examples 项目文档

# 可选目�?
mkdir 项目备份 归档文件 测试报告 自动生成文档

# 图片目录
mkdir image\README
```

#### 步骤4: 创建核心文件

```bash
# 主应�?
echo. > app.py

# 配置文件
echo. > requirements.txt
echo. > pytest.ini
echo. > .gitignore

# 文档
echo. > README.md
```

#### 步骤5: 修改规则系统配置

编辑两个文件�?

1. **`.windsurf/project-config.md`**
   - 修改项目名称
   - 修改项目路径
   - 调整目录结构定义

2. **`.windsurf/scripts/check_project_structure.py`**
   - 修改 `allowed_items` 列表
   - 适配你的项目目录�?

---

## 📖 架构模板详解

### 核心理念

**10大目录分�?*:

| 序号 | 分类 | 目录 | 职责 |
|------|------|------|------|
| 1️⃣ | 核心代码�?| 根目�?| app.py, requirements.txt |
| 2️⃣ | 数据存储�?| data/ | 核心数据文件 |
| 3️⃣ | 规范定义�?| schema/, spec/ | 数据验证和规范文�?|
| 4️⃣ | 工具脚本�?| scripts/ | 维护脚本和工�?|
| 5️⃣ | 测试�?| tests/ | 所有测试文�?|
| 6️⃣ | 文档�?| 项目文档/ | 手写文档 |
| 7️⃣ | 备份归档�?| 项目备份/, 归档文件/ | 版本备份和归�?|
| 8️⃣ | 知识库区 | 1_xxx_源参考文�? | 只读参�?|
| 9️⃣ | 配置环境 | .venv/, .vscode/ | 开发环�?|
| 🔟 | 规则系统 | .windsurf/ | AI规则系统 |

---

## 🎨 目录设计原则

### 1. 分层清晰

```
�?好的设计:
项目/
├── app.py              # 代码
├── data/               # 数据
├── tests/              # 测试
└── 项目文档/            # 文档

�?不好的设�?
项目/
├── app.py
├── test_app.py         # 测试混在代码�?
├── data.json           # 数据在根目录
└── README.md
```

### 2. 职责单一

**每个目录只做一件事**:
- `scripts/` - 只放维护脚本
- `tests/` - 只放测试文件
- `data/` - 只放数据文件

### 3. 易于扩展

```
初始结构:
data/
└── data.json

扩展�?
data/
├── v1/
�?  └── data.json
└── v2/
    └── data.json
```

---

## 🔧 常见场景

### 场景1: FastAPI REST API项目

**完全符合此模�?*

```
项目/
├── app.py                    # FastAPI应用
├── data/                     # JSON数据
├── schema/                   # Pydantic schemas
├── tests/                    # API测试
└── .windsurf/           # 规则系统
```

### 场景2: 数据库驱动项�?

**需要添加migrations目录**

```
项目/
├── app.py
├── migrations/               # 数据库迁移脚�?�?新增
�?  ├── versions/
�?  └── alembic.ini
├── models/                   # ORM模型 �?新增
├── tests/
└── .windsurf/
```

### 场景3: 前端+后端全栈项目

**需要分离前后端目录**

```
项目/
├── backend/                  # 后端目录 �?调整
�?  ├── app.py
�?  ├── data/
�?  └── tests/
├── frontend/                 # 前端目录 �?新增
�?  ├── src/
�?  ├── public/
�?  └── package.json
└── .windsurf/
```

---

## 💡 最佳实�?

### 1. 使用配置集中管理

**创建 `scripts/_config.py`**:
```python
from pathlib import Path

# 项目根目�?
PROJECT_ROOT = Path(__file__).parent.parent

# 目录路径
DATA_DIR = PROJECT_ROOT / "data"
SCHEMA_DIR = PROJECT_ROOT / "schema"
TESTS_DIR = PROJECT_ROOT / "tests"

# 文件路径
DATA_FILE = DATA_DIR / "data.json"
```

**好处**:
- �?路径统一管理
- �?修改一处，全局生效
- �?避免硬编�?

### 2. 保持根目录整�?

```bash
# �?根目录只放核心文�?
app.py
requirements.txt
README.md
.gitignore

# �?不要在根目录堆积
test.py              # �?应该�?tests/
backup.json          # �?应该�?项目备份/
temp.txt             # �?临时文件应该删除
```

### 3. 使用自动化脚�?

```bash
# 数据验证
python scripts/validate_data.py

# 生成文档
python scripts/generate_docs.py

# 项目统计
python scripts/get_stats.py
```

### 4. 版本备份规范

```bash
# 命名格式
v{版本号}-{描述}_{日期}_{时间}/

# 示例
项目备份/
├── v1.0.0-initial-release_20251126_100000/
├── v1.1.0-add-feature_20251201_143000/
└── v2.0.0-major-refactor_20251215_091500/
```

---

## 📋 创建清单

### 必需�?�?

```bash
�?README.md                    # 项目说明
�?app.py                       # 主应�?
�?requirements.txt             # 依赖清单
�?.gitignore                   # Git忽略规则

�?data/                        # 数据目录
�?schema/                      # Schema目录
�?scripts/                     # 脚本目录
�?tests/                       # 测试目录

�?.windsurf/              # 规则系统
  �?project-config.md          # 已修改配�?
  �?check_project_structure.py # 已调整allowed_items
```

### 推荐�?�?

```bash
�?spec/                        # 规范文档
�?examples/                    # 示例代码
�?项目文档/                     # 手写文档

�?pytest.ini                   # Pytest配置
�?Dockerfile                   # Docker镜像
�?docker-compose.yml           # Docker编排

�?start_api.bat                # 启动脚本
```

### 可选项 �?

```bash
�?项目备份/                     # 版本备份
�?归档文件/                     # 历史归档
�?测试报告/                     # 测试输出
�?自动生成文档/                 # 自动生成的文�?
�?1_xxx_源参考文�?             # 知识�?
```

---

## 🚨 常见错误

### 错误1: 目录结构混乱

**问题**:
```
项目/
├── app.py
├── test_api.py              # 测试文件在根目录
├── backup_20251126.json     # 备份在根目录
└── 临时笔记.txt              # 临时文件在根目录
```

**解决**:
```
项目/
├── app.py
├── tests/
�?  └── test_api.py          # �?测试文件在tests/
├── 项目备份/
�?  └── backup_20251126.json # �?备份在项目备�?
└── .gitignore               # �?临时文件被忽略或删除
```

### 错误2: 硬编码路�?

**问题**:
```python
# �?硬编码绝对路�?
data_path = "D:/Projects/MyProject/data/data.json"
```

**解决**:
```python
# �?使用相对路径
from pathlib import Path
PROJECT_ROOT = Path(__file__).parent.parent
data_path = PROJECT_ROOT / "data" / "data.json"

# �?使用配置文件
from scripts._config import DATA_FILE
data_path = DATA_FILE
```

### 错误3: 忘记更新规则系统配置

**问题**: 复制了规则系统但没有修改配置

**解决**:
1. �?修改 `.windsurf/project-config.md`
2. �?修改 `.windsurf/scripts/check_project_structure.py`
3. �?运行验证: `python .windsurf/scripts/check_project_structure.py`

---

## 🔍 验证检�?

### 运行结构检�?

```bash
python .windsurf\scripts\check_project_structure.py
```

**期望输出**:
```
�?项目结构基本符合规范
```

### 运行移植性验�?

```bash
python .windsurf\scripts\verify_portability.py
```

**期望输出**:
```
📊 移植性评�? 100/100 ⭐⭐⭐⭐�?完美
```

---

## 📚 参考文�?

### 规则系统文档

1. **架构模板** - `.windsurf/06-directory-architecture-template.md`
2. **核心原则** - `.windsurf/00-core-principles.md`
3. **目录管理** - `.windsurf/02-directory-management.md`
4. **文件操作** - `.windsurf/01-file-operations.md`

### 工具脚本

1. **init_project_from_template.py** - 项目初始�?
2. **check_project_structure.py** - 结构检�?
3. **verify_portability.py** - 移植性验�?

---

## 💬 常见问题

### Q1: 我的项目不是FastAPI，能用这个模板吗�?

**A**: 可以！架构模板的核心�?*目录分类理念**，不限定技术栈�?

调整建议�?
- Django项目 �?保留核心结构，调整app目录
- Flask项目 �?完全适用
- 爬虫项目 �?添加output/目录存储结果
- 数据分析项目 �?添加notebooks/目录

### Q2: 必须完全按照模板创建吗？

**A**: 不必须，但建�?*保留核心分类**�?

必需的分类：
- �?代码区（根目录或src/�?
- �?测试区（tests/�?
- �?文档区（项目文档/或docs/�?
- �?规则系统�?windsurfrules/�?

可选的分类�?
- �?备份�?
- �?归档�?
- �?知识库区

### Q3: 规则系统会自动强制架构吗�?

**A**: 架构模板�?*参考建�?*，不是强制规则�?

- 📖 `06-directory-architecture-template.md` 是参考文�?
- 🔴 `check_project_structure.py` 会检�?`allowed_items`
- ✏️ 你需要手动修�?`allowed_items` 以匹配你的目�?

### Q4: 如何让团队成员快速上手？

**A**: 使用初始化脚�?+ 文档

```bash
# 1. 分享规则系统
�?.windsurf/ 添加到项�?

# 2. 团队成员阅读文档
README.md
.windsurf/06-directory-architecture-template.md

# 3. 查看架构使用指南
.windsurf/架构模板使用指南.md
```

---

## 🎓 进阶技�?

### 技�?: 创建项目模板仓库

```bash
# 1. 创建模板仓库
mkdir ProjectTemplate
cd ProjectTemplate

# 2. 运行初始化脚�?
python init_project_from_template.py Template .

# 3. 提交到Git
git init
git add .
git commit -m "Initial template"
git remote add origin <your-repo-url>
git push -u origin main

# 4. 使用模板创建新项�?
git clone <template-repo-url> MyNewProject
```

### 技�?: 自定义初始化脚本

修改 `init_project_from_template.py`�?
- 添加你常用的依赖
- 调整目录结构
- 自定义文件模�?

### 技�?: 配合项目管理工具

```bash
# 与Makefile结合
make init          # 初始化项�?
make test          # 运行测试
make docs          # 生成文档
make check         # 结构检�?

# 与pre-commit结合
# .pre-commit-config.yaml
hooks:
  - id: check-structure
    entry: python .windsurf/scripts/check_project_structure.py
```

---

## 🔄 持续改进

### 收集反馈

如果你在使用中发现：
- �?新的最佳实�?
- 🐛 模板的问�?
- 💡 改进建议

请记录在�?
- `项目文档/架构改进建议.md`
- 或提交到规则系统的Issue

### 版本演进

架构模板会随着实践不断改进�?
- v1.0 - 初始版本（基于owlRD原型项目提炼�?
- v1.1 - 支持更多项目类型（全�?后端/前端/微服�?数据科学�?
- v2.0 - 计划：添加更多架构变体和最佳实�?

---

**创建日期**: 2025-11-26  
**最后更�?*: 2025-11-26  
**维护�?*: Cascade AI  
**状�?*: �?稳定使用

🎉 **开始使用架构模板，快速搭建规范的项目结构�?*