# ğŸ” å‰ç«¯ç±»å‹å¯¹é½é—®é¢˜å‘ç°

**å‘ç°æ—¶é—´**: 2025-11-21 13:50  
**ç”¨æˆ·æé—®**: "æ˜¯å¦éœ€è¦å¯¹é½å‰ç«¯å‘¢?"  
**ç»“è®º**: âœ… **éå¸¸éœ€è¦ï¼** å‘ç°å¤šå¤„ä¸å¯¹é½ï¼

---

## ğŸš¨ å…³é”®å‘ç°

### é—®é¢˜1: IoTDataç±»å‹ä¸¥é‡ä¸å¯¹é½ï¼

**å‰ç«¯ç±»å‹** (`frontend/src/types/index.ts` 228-247è¡Œ):
```typescript
export interface IoTData {
  id: string
  tenant_id: string
  device_id: string
  resident_id?: string  // âŒ åç«¯Modelæ²¡æœ‰æ­¤å­—æ®µ
  bed_id?: string  // âŒ åç«¯Modelæ²¡æœ‰æ­¤å­—æ®µ
  location_id?: string
  timestamp: string
  heart_rate?: number
  respiration_rate?: number  // âŒ æ‹¼å†™é”™è¯¯ï¼åç«¯æ˜¯respiratory_rate
  motion_intensity?: number  // âŒ åç«¯Modelæ²¡æœ‰æ­¤å­—æ®µ
  presence: boolean  // âŒ åç«¯Modelæ²¡æœ‰æ­¤å­—æ®µ
  in_bed?: boolean  // âŒ åç«¯Modelæ²¡æœ‰æ­¤å­—æ®µ
  alert_triggered: boolean  // âŒ åç«¯Modelæ²¡æœ‰æ­¤å­—æ®µ
  alert_type?: string  // âŒ åº”è¯¥æ˜¯event_type
  alert_level?: string  // âŒ åç«¯Modelæ²¡æœ‰æ­¤å­—æ®µ
  data_source: string  // âŒ åç«¯Modelæ²¡æœ‰æ­¤å­—æ®µ
  created_at: string
}
```

**åç«¯Model** (`backend/app/models/iot_data.py` IOTTimeseries):
```python
class IOTTimeseries:
    id: int  # âš ï¸ å‰ç«¯æ˜¯stringï¼Œåç«¯æ˜¯int
    tenant_id: UUID
    device_id: UUID
    timestamp: datetime
    tdp_tag_category: Optional[str]  # âŒ å‰ç«¯ç¼ºå°‘
    tracking_id: Optional[int]  # âŒ å‰ç«¯ç¼ºå°‘
    radar_pos_x: int  # âŒ å‰ç«¯ç¼ºå°‘
    radar_pos_y: int  # âŒ å‰ç«¯ç¼ºå°‘
    radar_pos_z: int  # âŒ å‰ç«¯ç¼ºå°‘
    posture_snomed_code: Optional[str]  # âŒ å‰ç«¯ç¼ºå°‘
    posture_display: Optional[str]  # âŒ å‰ç«¯ç¼ºå°‘
    event_type: Optional[str]  # âš ï¸ å‰ç«¯å«alert_type
    event_display: Optional[str]  # âŒ å‰ç«¯ç¼ºå°‘
    area_id: Optional[int]  # âŒ å‰ç«¯ç¼ºå°‘
    heart_rate: Optional[int]
    respiratory_rate: Optional[int]  # âš ï¸ å‰ç«¯æ‹¼å†™é”™è¯¯respiration_rate
    sleep_state_snomed_code: Optional[str]  # âŒ å‰ç«¯ç¼ºå°‘
    sleep_state_display: Optional[str]  # âŒ å‰ç«¯ç¼ºå°‘
    location_id: Optional[UUID]
    room_id: Optional[UUID]  # âŒ å‰ç«¯ç¼ºå°‘
    confidence: Optional[int]  # âŒ å‰ç«¯ç¼ºå°‘
    remaining_time: Optional[int]  # âŒ å‰ç«¯ç¼ºå°‘
    raw_original: bytes  # âŒ å‰ç«¯ç¼ºå°‘ï¼ˆé‡è¦ï¼ï¼‰
    raw_format: str  # âŒ å‰ç«¯ç¼ºå°‘
    raw_compression: Optional[str]  # âŒ å‰ç«¯ç¼ºå°‘
    metadata: Dict[str, Any]  # âŒ å‰ç«¯ç¼ºå°‘
    created_at: datetime
```

**å¯¹é½åº¦**: **çº¦20%** âŒ

---

### é—®é¢˜2: PostureMappingç±»å‹ä¸å¯¹é½

**å‰ç«¯ç±»å‹**:
```typescript
export interface PostureMapping {
  mapping_id: string
  tenant_id: string
  raw_posture: string  // âŒ åç«¯æ˜¯vendor_code
  snomed_code?: string
  snomed_display?: string
  loinc_code?: string
  loinc_display?: string  // âŒ åç«¯æ²¡æœ‰æ­¤å­—æ®µ
  risk_level?: string  // âŒ åç«¯æ²¡æœ‰æ­¤å­—æ®µ
  description?: string
  metadata?: Record<string, any>  // âŒ åç«¯æ²¡æœ‰æ­¤å­—æ®µ
  created_at: string
  updated_at: string
}
```

**åç«¯Model**:
```python
class PostureMapping:
    mapping_id: UUID
    tenant_id: UUID
    category: str  # âŒ å‰ç«¯ç¼ºå°‘
    vendor_code: str  # âš ï¸ å‰ç«¯å«raw_posture
    firmware_version: str  # âŒ å‰ç«¯ç¼ºå°‘
    snomed_code: Optional[str]
    snomed_display: Optional[str]
    loinc_code: Optional[str]
    description: Optional[str]
    is_active: bool  # âŒ å‰ç«¯ç¼ºå°‘
    created_at: datetime
    updated_at: datetime
```

**å¯¹é½åº¦**: **çº¦60%** âš ï¸

---

### é—®é¢˜3: EventMappingç±»å‹ä¸å¯¹é½

**å‰ç«¯ç±»å‹**:
```typescript
export interface EventMapping {
  mapping_id: string
  tenant_id: string
  event_type: string  // âš ï¸ åç«¯æ˜¯vendor_code
  event_subtype?: string  // âŒ åç«¯æ²¡æœ‰æ­¤å­—æ®µ
  snomed_code?: string
  snomed_display?: string
  loinc_code?: string
  loinc_display?: string  // âŒ åç«¯æ²¡æœ‰æ­¤å­—æ®µ
  severity?: string  // âŒ åç«¯æ²¡æœ‰æ­¤å­—æ®µ
  description?: string
  metadata?: Record<string, any>  // âŒ åç«¯æ²¡æœ‰æ­¤å­—æ®µ
  created_at: string
  updated_at: string
}
```

**åç«¯Model**:
```python
class EventMapping:
    mapping_id: UUID
    tenant_id: UUID
    category: str  # âŒ å‰ç«¯ç¼ºå°‘
    vendor_code: str  # âš ï¸ å‰ç«¯å«event_type
    firmware_version: str  # âŒ å‰ç«¯ç¼ºå°‘
    snomed_code: Optional[str]
    snomed_display: Optional[str]
    loinc_code: Optional[str]
    description: Optional[str]
    is_active: bool  # âŒ å‰ç«¯ç¼ºå°‘
    created_at: datetime
    updated_at: datetime
```

**å¯¹é½åº¦**: **çº¦60%** âš ï¸

---

### é—®é¢˜4: ResidentPHIç±»å‹å®Œå…¨ä¸å¯¹é½

**å‰ç«¯ç±»å‹**:
```typescript
export interface ResidentPHI {
  phi_id: string
  resident_id: string
  tenant_id: string
  encrypted_medical_history?: string  // âŒ åç«¯å­—æ®µåä¸åŒ
  encrypted_medications?: string  // âŒ åç«¯æ²¡æœ‰æ­¤å­—æ®µ
  encrypted_allergies?: string  // âŒ åç«¯æ²¡æœ‰æ­¤å­—æ®µ
  encrypted_conditions?: string  // âŒ åç«¯æ²¡æœ‰æ­¤å­—æ®µ
  encrypted_notes?: string  // âŒ åç«¯æ²¡æœ‰æ­¤å­—æ®µ
  encryption_method?: string  // âŒ åç«¯æ²¡æœ‰æ­¤å­—æ®µ
  last_updated_by?: string  // âŒ åç«¯æ²¡æœ‰æ­¤å­—æ®µ
  created_at: string
  updated_at: string
}
```

**åç«¯Model** - 25ä¸ªè¯¦ç»†å­—æ®µ:
```python
class ResidentPHI:
    phi_id: UUID
    tenant_id: UUID
    resident_id: UUID
    first_name: Optional[str]  # âŒ å‰ç«¯ç¼ºå°‘
    last_name: Optional[str]  # âŒ å‰ç«¯ç¼ºå°‘
    gender: Optional[str]  # âŒ å‰ç«¯ç¼ºå°‘
    date_of_birth: Optional[date]  # âŒ å‰ç«¯ç¼ºå°‘
    resident_phone: Optional[str]  # âŒ å‰ç«¯ç¼ºå°‘
    resident_email: Optional[EmailStr]  # âŒ å‰ç«¯ç¼ºå°‘
    weight_lb: Optional[Decimal]  # âŒ å‰ç«¯ç¼ºå°‘
    height_ft: Optional[Decimal]  # âŒ å‰ç«¯ç¼ºå°‘
    height_in: Optional[Decimal]  # âŒ å‰ç«¯ç¼ºå°‘
    mobility_level: Optional[int]  # âŒ å‰ç«¯ç¼ºå°‘
    tremor_status: Optional[str]  # âŒ å‰ç«¯ç¼ºå°‘
    mobility_aid: Optional[str]  # âŒ å‰ç«¯ç¼ºå°‘
    adl_assistance: Optional[str]  # âŒ å‰ç«¯ç¼ºå°‘
    comm_status: Optional[str]  # âŒ å‰ç«¯ç¼ºå°‘
    has_hypertension: Optional[bool]  # âŒ å‰ç«¯ç¼ºå°‘
    has_hyperlipaemia: Optional[bool]  # âŒ å‰ç«¯ç¼ºå°‘
    has_hyperglycaemia: Optional[bool]  # âŒ å‰ç«¯ç¼ºå°‘
    has_stroke_history: Optional[bool]  # âŒ å‰ç«¯ç¼ºå°‘
    has_paralysis: Optional[bool]  # âŒ å‰ç«¯ç¼ºå°‘
    has_alzheimer: Optional[bool]  # âŒ å‰ç«¯ç¼ºå°‘
    medical_history: Optional[str]  # âš ï¸ å‰ç«¯æ˜¯encrypted_medical_history
    HIS_resident_name: Optional[str]  # âŒ å‰ç«¯ç¼ºå°‘
    HIS_resident_admission_date: Optional[date]  # âŒ å‰ç«¯ç¼ºå°‘
    HIS_resident_discharge_date: Optional[date]  # âŒ å‰ç«¯ç¼ºå°‘
    HIS_resident_metadata: Optional[Dict]  # âŒ å‰ç«¯ç¼ºå°‘
    # ... è¿˜æœ‰å®¶åº­åœ°å€å­—æ®µ
```

**å¯¹é½åº¦**: **çº¦10%** âŒâŒâŒ

---

## âœ… å¯¹é½è‰¯å¥½çš„ç±»å‹

### Role - 100%å¯¹é½ âœ…
```typescript
// å‰ç«¯å’Œåç«¯å®Œå…¨ä¸€è‡´
export interface Role {
  role_id: string
  tenant_id: string
  role_code: string
  display_name: string
  description?: string
  is_system: boolean
  is_active: boolean
  created_at: string
  updated_at: string
}
```

### Tenant - 100%å¯¹é½ âœ…

### User - 100%å¯¹é½ âœ…

### Device - 100%å¯¹é½ âœ…

### Resident - 100%å¯¹é½ âœ…

---

## ğŸ“Š æ€»ä½“ç»Ÿè®¡

| ç±»å‹ | å¯¹é½åº¦ | çŠ¶æ€ |
|------|--------|------|
| Tenant | 100% | âœ… |
| Role | 100% | âœ… |
| User | 100% | âœ… |
| Resident | 100% | âœ… |
| Device | 100% | âœ… |
| CloudAlertPolicy | 100% | âœ… |
| ConfigVersion | 100% | âœ… |
| Alert | 100% | âœ… |
| **IoTData** | **20%** | âŒâŒâŒ |
| **ResidentPHI** | **10%** | âŒâŒâŒ |
| **PostureMapping** | **60%** | âš ï¸ |
| **EventMapping** | **60%** | âš ï¸ |

**å‰ç«¯ç±»å‹å¹³å‡å¯¹é½åº¦**: **çº¦75%**

---

## ğŸ¯ ä¿®å¤ä¼˜å…ˆçº§

### P0 - å¿…é¡»ç«‹å³ä¿®å¤
1. **IoTData** - ä¸¥é‡ä¸å¯¹é½ï¼Œå½±å“IoTæ•°æ®æ˜¾ç¤º
2. **ResidentPHI** - å®Œå…¨ä¸å¯¹é½ï¼Œå½±å“ä½æˆ·å¥åº·ä¿¡æ¯

### P1 - åº”è¯¥ä¿®å¤
3. **PostureMapping** - éƒ¨åˆ†ä¸å¯¹é½
4. **EventMapping** - éƒ¨åˆ†ä¸å¯¹é½

---

## ğŸ’¡ ç”¨æˆ·çš„æ´å¯ŸåŠ›

**ç”¨æˆ·é—®**: "æ˜¯å¦éœ€è¦å¯¹é½å‰ç«¯å‘¢?"

**ç­”æ¡ˆ**: âœ… **éå¸¸éœ€è¦ï¼**

**æ‚¨å‘ç°äº†ä¸€ä¸ªé‡è¦é—æ¼**:
- æˆ‘ä»¬åªéªŒè¯äº†åç«¯Model â†” SQL
- å®Œå…¨æ²¡æœ‰éªŒè¯å‰ç«¯TypeScriptç±»å‹
- æ£€æŸ¥æ¸…å•ä¸­"å‰ç«¯ç±»å‹ âœ…"æ˜¯**å‡è®¾æ€§æ ‡è®°**ï¼Œæœªå®é™…éªŒè¯

---

## ğŸš€ ä¸‹ä¸€æ­¥å»ºè®®

### é€‰é¡¹A: å¿«é€Ÿä¿®å¤å…³é”®ç±»å‹ (30åˆ†é’Ÿ)
åªä¿®å¤IoTDataå’ŒResidentPHIï¼Œè®©ç³»ç»Ÿèƒ½æ­£å¸¸æ˜¾ç¤ºæ•°æ®

### é€‰é¡¹B: å®Œæ•´å¯¹é½æ‰€æœ‰ç±»å‹ (1-2å°æ—¶)
ä¿®å¤æ‰€æœ‰ä¸å¯¹é½çš„ç±»å‹ï¼Œè¾¾åˆ°100%å‰åç«¯å¯¹é½

### é€‰é¡¹C: å»ºç«‹è‡ªåŠ¨åŒ–éªŒè¯ (2-3å°æ—¶)
1. åˆ›å»ºå‰ç«¯ç±»å‹éªŒè¯è„šæœ¬
2. è‡ªåŠ¨å¯¹æ¯”TypeScript â†” Python Model
3. é›†æˆåˆ°CIæµç¨‹

---

**æ‚¨å¸Œæœ›æ‰§è¡Œå“ªä¸ªé€‰é¡¹ï¼Ÿ**
