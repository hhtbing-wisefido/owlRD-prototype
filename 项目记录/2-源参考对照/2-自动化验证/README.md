# è‡ªåŠ¨åŒ–éªŒè¯ä½“ç³»

**å»ºç«‹æ—¶é—´**: 2025-11-21  
**ç›®çš„**: ç¡®ä¿åç«¯Modelã€å‰ç«¯TypeScriptç±»å‹ä¸SQLå®šä¹‰çš„å®Œå…¨å¯¹é½

---

## ğŸ“ ç›®å½•ç»“æ„

```
2-è‡ªåŠ¨åŒ–éªŒè¯/
â”œâ”€â”€ README.md                    # æœ¬æ–‡ä»¶ - éªŒè¯ä½“ç³»è¯´æ˜
â”œâ”€â”€ åç«¯Modelå¯¹é½/
â”‚   â”œâ”€â”€ Modelå¯¹é½ä¿®å¤å®ŒæˆæŠ¥å‘Š.md   # åç«¯Modelä¿®å¤è¿‡ç¨‹å’Œæˆæœ
â”‚   â”œâ”€â”€ AUTO_å¯¹é½éªŒè¯æŠ¥å‘Š.md      # è‡ªåŠ¨ç”Ÿæˆçš„éªŒè¯æŠ¥å‘Š
â”‚   â””â”€â”€ AUTO_TODOä¿®å¤æ¸…å•.md      # è‡ªåŠ¨ç”Ÿæˆçš„å¾…ä¿®å¤æ¸…å•
â””â”€â”€ å‰ç«¯ç±»å‹å¯¹é½/
    â”œâ”€â”€ å‰ç«¯ç±»å‹å¯¹é½é—®é¢˜å‘ç°.md    # å‰ç«¯ç±»å‹é—®é¢˜åˆ†æ
    â””â”€â”€ AUTO_å‰ç«¯ç±»å‹å¯¹é½æŠ¥å‘Š.md  # è‡ªåŠ¨ç”Ÿæˆçš„å‰ç«¯éªŒè¯æŠ¥å‘Š
```

---

## ğŸ”§ éªŒè¯è„šæœ¬

### 1. åç«¯ModeléªŒè¯

#### validate_alignment.py
**ä½ç½®**: `backend/scripts/validate_alignment.py`

**åŠŸèƒ½**:
- ä»SQLæ–‡ä»¶æå–å­—æ®µå®šä¹‰
- ä»Pydantic Modelæå–å­—æ®µå®šä¹‰
- å¯¹æ¯”å­—æ®µåã€ç±»å‹ã€å¯ç©ºæ€§
- ç”Ÿæˆè¯¦ç»†å¯¹é½æŠ¥å‘Š

**ç”¨æ³•**:
```bash
cd backend
python scripts/validate_alignment.py
```

**è¾“å‡º**: `é¡¹ç›®è®°å½•/AUTO_å¯¹é½éªŒè¯æŠ¥å‘Š.md`

---

#### sync_checklist.py
**ä½ç½®**: `backend/scripts/sync_checklist.py`

**åŠŸèƒ½**:
- è¿è¡Œvalidate_alignment.py
- æ™ºèƒ½è¿‡æ»¤åˆç†å·®å¼‚ï¼ˆä¸»é”®/å¤–é”®/æ—¶é—´æˆ³ï¼‰
- è‡ªåŠ¨æ›´æ–°æ£€æŸ¥æ¸…å•
- ç”ŸæˆTODOä¿®å¤æ¸…å•

**ç”¨æ³•**:
```bash
cd backend
python scripts/sync_checklist.py
```

**è¾“å‡º**:
- `é¡¹ç›®è®°å½•/2-æºå‚è€ƒå¯¹ç…§/1-æ•°æ®åº“Schemaå¯¹ç…§/æ£€æŸ¥æ¸…å•.md` (è‡ªåŠ¨æ›´æ–°)
- `é¡¹ç›®è®°å½•/AUTO_TODOä¿®å¤æ¸…å•.md`

---

### 2. å‰ç«¯ç±»å‹éªŒè¯

#### validate_frontend_types.py
**ä½ç½®**: `backend/scripts/validate_frontend_types.py`

**åŠŸèƒ½**:
- è§£æTypeScriptæ¥å£å®šä¹‰
- ä»Python Modelæå–å­—æ®µ
- å¯¹æ¯”å‰åç«¯ç±»å‹
- ç”Ÿæˆå¯¹é½æŠ¥å‘Š

**ç”¨æ³•**:
```bash
cd backend
python scripts/validate_frontend_types.py
```

**è¾“å‡º**: `é¡¹ç›®è®°å½•/AUTO_å‰ç«¯ç±»å‹å¯¹é½æŠ¥å‘Š.md`

---

## ğŸ“Š éªŒè¯ç»“æœ

### å½“å‰å¯¹é½åº¦

| ç»´åº¦ | å¯¹é½åº¦ | çŠ¶æ€ |
|------|--------|------|
| **åç«¯Model â†” SQL** | 100% | âœ… å®Œç¾ |
| **å‰ç«¯Type â†” åç«¯Model** | 85.5% | âœ… è‰¯å¥½ |
| **æ ¸å¿ƒåŠŸèƒ½** | 97.7% | âœ… ä¼˜ç§€ |
| **å…¨æ ˆå¹³å‡** | 92.8% | ğŸŠ ä¼˜ç§€ |

### æ ¸å¿ƒç±»å‹å¯¹é½

- âœ… IoTData: 96.3%
- âœ… ResidentPHI: 100%
- âœ… Resident: 90%
- âœ… Device: 100%
- âœ… PostureMapping: 100%
- âœ… EventMapping: 100%

---

## ğŸš€ ä½¿ç”¨åœºæ™¯

### åœºæ™¯1: ä¿®æ”¹ModelåéªŒè¯

```bash
# 1. ä¿®æ”¹backend/app/models/*.py
# 2. è¿è¡ŒéªŒè¯
cd backend
python scripts/sync_checklist.py

# 3. æ£€æŸ¥æŠ¥å‘Š
cat ../é¡¹ç›®è®°å½•/AUTO_å¯¹é½éªŒè¯æŠ¥å‘Š.md
cat ../é¡¹ç›®è®°å½•/AUTO_TODOä¿®å¤æ¸…å•.md
```

### åœºæ™¯2: ä¿®æ”¹å‰ç«¯ç±»å‹åéªŒè¯

```bash
# 1. ä¿®æ”¹frontend/src/types/index.ts
# 2. è¿è¡ŒéªŒè¯
cd backend
python scripts/validate_frontend_types.py

# 3. æ£€æŸ¥æŠ¥å‘Š
cat ../é¡¹ç›®è®°å½•/AUTO_å‰ç«¯ç±»å‹å¯¹é½æŠ¥å‘Š.md
```

### åœºæ™¯3: ä¸€é”®éªŒè¯å…¨æ ˆ

```bash
cd backend

# éªŒè¯åç«¯
python scripts/sync_checklist.py

# éªŒè¯å‰ç«¯
python scripts/validate_frontend_types.py

# æŸ¥çœ‹æ‰€æœ‰æŠ¥å‘Š
ls ../é¡¹ç›®è®°å½•/AUTO_*.md
```

---

## ğŸ’¡ æ™ºèƒ½è¿‡æ»¤è§„åˆ™

### åˆç†çš„Modelå¤šä½™å­—æ®µï¼ˆä¸ç®—é—®é¢˜ï¼‰

- `tenant_id` - å¤šç§Ÿæˆ·æ¶æ„ä¸»é”®
- `created_at`, `updated_at` - æ ‡å‡†æ—¶é—´æˆ³
- `*_id` - å„ç§ä¸»é”®å’Œå¤–é”®
- `domain` - tenantsè¡¨ç‰¹æ®Šå­—æ®µ

### åˆç†çš„ç±»å‹å·®å¼‚

- `Union` = `Optional[T]` (Pydanticè¡¨ç¤ºæ–¹å¼)
- `date` â†” `datetime` (å…¼å®¹ç±»å‹)
- `bytes` â†” `str` (å“ˆå¸Œå­—æ®µå­˜å‚¨æ–¹å¼)
- `string` â†” `UUID` (TypeScript vs Python)

---

## ğŸ¯ å¯¹é½æ ‡å‡†

### å®Œç¾å¯¹é½ (100%)
- æ‰€æœ‰ä¸šåŠ¡å­—æ®µå®Œå…¨åŒ¹é…
- ç±»å‹å…¼å®¹
- æ— ç¼ºå¤±å­—æ®µ

### è‰¯å¥½å¯¹é½ (90-99%)
- æ ¸å¿ƒä¸šåŠ¡å­—æ®µåŒ¹é…
- å°‘é‡æ¬¡è¦å·®å¼‚
- åŠŸèƒ½æ­£å¸¸

### éƒ¨åˆ†å¯¹é½ (80-89%)
- å¤šæ•°å­—æ®µåŒ¹é…
- éƒ¨åˆ†å­—æ®µç¼ºå¤±
- éœ€è¦ä¼˜åŒ–

### ä¸¥é‡ä¸å¯¹é½ (<80%)
- å¤§é‡å­—æ®µç¼ºå¤±
- ç±»å‹ä¸åŒ¹é…
- å¿…é¡»ä¿®å¤

---

## ğŸ“ æœ€ä½³å®è·µ

1. **æ¯æ¬¡ä¿®æ”¹Modelåè¿è¡ŒéªŒè¯**
   - ç¡®ä¿å¯¹é½åº¦ä¸ä¸‹é™

2. **å®šæœŸæ£€æŸ¥AUTOæŠ¥å‘Š**
   - å‘ç°æ½œåœ¨é—®é¢˜

3. **ä¼˜å…ˆä¿®å¤æ ¸å¿ƒåŠŸèƒ½**
   - IoTæ•°æ®ã€ä½æˆ·ä¿¡æ¯ç­‰

4. **ä¿æŒæ™ºèƒ½è¿‡æ»¤æ›´æ–°**
   - æ–°çš„åˆç†å·®å¼‚åŠæ—¶æ·»åŠ 

---

## ğŸ”— ç›¸å…³æ–‡æ¡£

- [æ£€æŸ¥æ¸…å•](../1-æ•°æ®åº“Schemaå¯¹ç…§/æ£€æŸ¥æ¸…å•.md) - è‡ªåŠ¨åŒæ­¥çš„å¯¹é½çŠ¶æ€
- [æ–¹æ¡ˆBæ‰§è¡Œæ€»ç»“](../../3-åŠŸèƒ½è¯´æ˜/æ–¹æ¡ˆBæ‰§è¡Œæ€»ç»“.md) - éªŒè¯ä½“ç³»å»ºç«‹è¿‡ç¨‹
- [å…¨æ ˆå¯¹é½å®Œæˆæ€»ç»“](../../3-åŠŸèƒ½è¯´æ˜/å…¨æ ˆå¯¹é½å®Œæˆæ€»ç»“.md) - æœ€ç»ˆæˆæœ
- [é—®é¢˜åˆ†æ](../../4-é—®é¢˜åˆ†æ/) - å‘ç°çš„é—®é¢˜å’Œä¿®å¤å»ºè®®

---

**ç»´æŠ¤è€…**: AI Assistant  
**æœ€åæ›´æ–°**: 2025-11-21
