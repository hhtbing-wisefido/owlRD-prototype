# ä½ç½®ç®¡ç†ç³»ç»Ÿè¯´æ˜

**æ–‡æ¡£ç‰ˆæœ¬**: v1.0  
**åˆ›å»ºæ—¶é—´**: 2025-11-21  
**å¯¹åº”SQL**: `04_locations.sql`, `05_rooms.sql`, `06_beds.sql`

---

## ğŸ“‹ æ¦‚è¿°

ä½ç½®ç®¡ç†ç³»ç»Ÿè´Ÿè´£ç®¡ç†å…»è€æœºæ„çš„ç‰©ç†ç©ºé—´å±‚çº§ç»“æ„ï¼?*ä½ç½®(Location) â†?æˆ¿é—´(Room) â†?åºŠä½(Bed)**ï¼Œæ”¯æŒæœºæ„åœºæ™¯ï¼ˆInstitutionalï¼‰å’Œå±…å®¶åœºæ™¯ï¼ˆHomeCareï¼‰ä¸¤ç§æ¨¡å¼ã€?
---

## ğŸ¢ ä¸‰å±‚ç©ºé—´ç»“æ„

### å±‚çº§1ï¼šLocationï¼ˆä½ç½?åœ°å€ï¼?
**ç”¨é€?*: æœ€é¡¶å±‚çš„ç©ºé—´å•å…ƒï¼Œä»£è¡¨ä¸€ä¸ªç‹¬ç«‹çš„ç›‘æ§åŒºåŸŸ

**æ”¯æŒåœºæ™¯**:
- **Institutionalï¼ˆæœºæ„åœºæ™¯ï¼‰**: å…»è€é™¢æˆ¿é—´ã€å…¬å…±ç©ºé—?- **HomeCareï¼ˆå±…å®¶åœºæ™¯ï¼‰**: ç‹¬ç«‹ä½å®…

**å…³é”®å­—æ®µ**:
- `location_name`: ä½ç½®åç§°ï¼ˆå¦‚"E203"ã€?201"ï¼?- `is_public_space`: æ˜¯å¦å…¬å…±ç©ºé—´ï¼ˆå¤§å…ã€èµ°å»Šï¼‰
- `is_multi_person_room`: æ˜¯å¦å¤šäººæˆ¿é—´
- `alert_user_ids` / `alert_tags`: å‘Šè­¦è·¯ç”±é…ç½®

**æ–‡ä»¶ä½ç½®**:
- åç«¯Model: `backend/app/models/location.py`
- åç«¯API: `backend/app/api/v1/locations.py`
- ç¤ºä¾‹æ•°æ®: `backend/app/data/locations.json`
- å‰ç«¯ç±»å‹: `frontend/src/types/index.ts:Location`

---

### å±‚çº§2ï¼šRoomï¼ˆæˆ¿é—´ï¼‰

**ç”¨é€?*: Location ä¸‹çš„å­ç©ºé—´ï¼Œé€šå¸¸æ˜¯ä¸€ä¸ªç‰©ç†æˆ¿é—?
**ä½¿ç”¨åœºæ™¯**:
- æœºæ„åœºæ™¯ä¸­çš„å¤šäººæˆ¿é—´éœ€è¦ç»†åˆ†æˆ¿é—´ç®¡ç?- å¤§å¥—æˆ¿ä¸­çš„ä¸åŒæˆ¿é—´ï¼ˆå¦‚å®¢å…ã€å§å®¤ï¼‰

**å…³é”®å­—æ®µ**:
- `room_number`: æˆ¿é—´å?- `room_type`: æˆ¿é—´ç±»å‹ï¼ˆå§å®¤ã€å®¢å…ç­‰ï¼?- `capacity`: å®¹çº³äººæ•°
- `is_occupied`: æ˜¯å¦å·²å ç”?
**æ–‡ä»¶ä½ç½®**:
- åç«¯Model: `backend/app/models/location.py:Room`
- åç«¯API: `backend/app/api/v1/locations.py`ï¼ˆroomsç«¯ç‚¹ï¼?- ç¤ºä¾‹æ•°æ®: `backend/app/data/rooms.json`
- å‰ç«¯ç±»å‹: `frontend/src/types/index.ts:Room`

---

### å±‚çº§3ï¼šBedï¼ˆåºŠä½ï¼‰

**ç”¨é€?*: æœ€å°çš„ç©ºé—´å•å…ƒï¼Œä»£è¡¨ä¸€ä¸ªåºŠä½ï¼Œç›´æ¥å…³è”ä½æˆ·

**å…³é”®ç‰¹æ€?*:
- **å”¯ä¸€æ€§çº¦æ?*: ä¸€ä¸ªåºŠä½åªèƒ½å…³è”ä¸€ä¸ªä½æˆ?- **åŒå‘ç»‘å®š**: 
  - `beds.resident_id` â†?åºŠä½ç»‘å®šçš„ä½æˆ?  - `residents.bed_id` â†?ä½æˆ·æ‰€åœ¨çš„åºŠä½
- **è®¾å¤‡ç»‘å®š**: è®¾å¤‡å¯é€šè¿‡ `devices.bound_bed_id` ç»‘å®šåˆ°åºŠä½?
**å…³é”®å­—æ®µ**:
- `bed_number`: åºŠä½å·ï¼ˆå¦?A"ã€?B"ã€?1"ã€?2"ï¼?- `resident_id`: å½“å‰ä½æˆ·ID
- `is_occupied`: æ˜¯å¦å·²å ç”?
**æ–‡ä»¶ä½ç½®**:
- åç«¯Model: `backend/app/models/location.py:Bed`
- åç«¯API: `backend/app/api/v1/locations.py`ï¼ˆbedsç«¯ç‚¹ï¼?- ç¤ºä¾‹æ•°æ®: `backend/app/data/beds.json`
- å‰ç«¯ç±»å‹: `frontend/src/types/index.ts:Bed`

---

## ğŸ”— ç»‘å®šè·¯å¾„æ€»ç»“

```
Location (ä½ç½®/åœ°å€)
  â”œâ”€â”€ Room (æˆ¿é—´)
  â”?    â”œâ”€â”€ Bed (åºŠä½)
  â”?    â”?    â”œâ”€â”€ Resident (ä½æˆ·) â†?residents.bed_id
  â”?    â”?    â””â”€â”€ Device (è®¾å¤‡) â†?devices.bound_bed_id
  â”?    â””â”€â”€ Device (è®¾å¤‡) â†?devices.bound_room_id
  â”œâ”€â”€ Resident (ä½æˆ·) â†?residents.location_id (HomeCare/å•äººé—?
  â””â”€â”€ Device (è®¾å¤‡) â†?devices.location_id (æœªç»‘åºŠçš„è®¾å¤‡)
```

---

## ğŸ“Š æ•°æ®è¡¨ç»“æ?
### Locations è¡?
| å­—æ®µ | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| location_id | UUID | ä¸»é”® |
| tenant_id | UUID | ç§Ÿæˆ·ID |
| location_name | String | ä½ç½®åç§° |
| location_tag | String | ä½ç½®æ ‡ç­¾ï¼ˆå¯é€‰ï¼‰ |
| building | String | æ¥¼æ ‹ï¼ˆæœºæ„åœºæ™¯ï¼‰ |
| floor | String | æ¥¼å±‚ |
| door_number | String | é—¨ç‰Œå?|
| location_type | String | Institutional / HomeCare |
| is_public_space | Boolean | æ˜¯å¦å…¬å…±ç©ºé—´ |
| is_multi_person_room | Boolean | æ˜¯å¦å¤šäººæˆ¿é—´ |
| alert_user_ids | UUID[] | å‘Šè­¦æ¥æ”¶è€…ID |
| alert_tags | String[] | å‘Šè­¦æ¥æ”¶è€…æ ‡ç­?|
| layout_config | JSON | æˆ¿é—´å¸ƒå±€é…ç½® |
| timezone | String | æ—¶åŒº |
| is_active | Boolean | æ˜¯å¦å¯ç”¨ |

### Rooms è¡?
| å­—æ®µ | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| room_id | UUID | ä¸»é”® |
| tenant_id | UUID | ç§Ÿæˆ·ID |
| location_id | UUID | æ‰€å±ä½ç½?|
| room_number | String | æˆ¿é—´å?|
| room_type | String | æˆ¿é—´ç±»å‹ |
| capacity | Integer | å®¹çº³äººæ•° |
| floor | Integer | æ¥¼å±‚ |
| is_occupied | Boolean | æ˜¯å¦å ç”¨ |
| metadata | JSON | æ‰©å±•ä¿¡æ¯ |

### Beds è¡?
| å­—æ®µ | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| bed_id | UUID | ä¸»é”® |
| tenant_id | UUID | ç§Ÿæˆ·ID |
| room_id | UUID | æ‰€å±æˆ¿é—?|
| bed_number | String | åºŠä½å?|
| resident_id | UUID | å½“å‰ä½æˆ· |
| is_occupied | Boolean | æ˜¯å¦å ç”¨ |
| metadata | JSON | æ‰©å±•ä¿¡æ¯ |

---

## ğŸš€ API ç«¯ç‚¹

### Locations

```bash
GET    /api/v1/locations          # è·å–ä½ç½®åˆ—è¡¨
GET    /api/v1/locations/{id}     # è·å–å•ä¸ªä½ç½®
POST   /api/v1/locations          # åˆ›å»ºä½ç½®
PUT    /api/v1/locations/{id}     # æ›´æ–°ä½ç½®
DELETE /api/v1/locations/{id}     # åˆ é™¤ä½ç½®
```

### Rooms

```bash
GET    /api/v1/rooms               # è·å–æˆ¿é—´åˆ—è¡¨
GET    /api/v1/rooms/{id}          # è·å–å•ä¸ªæˆ¿é—´
POST   /api/v1/rooms               # åˆ›å»ºæˆ¿é—´
PUT    /api/v1/rooms/{id}          # æ›´æ–°æˆ¿é—´
DELETE /api/v1/rooms/{id}          # åˆ é™¤æˆ¿é—´
```

### Beds

```bash
GET    /api/v1/beds                # è·å–åºŠä½åˆ—è¡¨
GET    /api/v1/beds/{id}           # è·å–å•ä¸ªåºŠä½
POST   /api/v1/beds                # åˆ›å»ºåºŠä½
PUT    /api/v1/beds/{id}           # æ›´æ–°åºŠä½
DELETE /api/v1/beds/{id}           # åˆ é™¤åºŠä½
```

---

## ğŸ’¡ ä½¿ç”¨åœºæ™¯ç¤ºä¾‹

### åœºæ™¯1ï¼šæœºæ„å…»è€é™¢ - å•äººæˆ¿é—´

```
Location (E203)
  â”œâ”€â”€ is_public_space: false
  â”œâ”€â”€ is_multi_person_room: false
  â””â”€â”€ Bed (A)
        â””â”€â”€ Resident (å¼ ä¸‰)
```

### åœºæ™¯2ï¼šæœºæ„å…»è€é™¢ - å¤šäººæˆ¿é—´

```
Location (201)
  â”œâ”€â”€ is_public_space: false
  â”œâ”€â”€ is_multi_person_room: true
  â”œâ”€â”€ Room (å§å®¤A)
  â”?    â””â”€â”€ Bed (1)
  â”?          â””â”€â”€ Resident (æå››)
  â””â”€â”€ Room (å§å®¤B)
        â””â”€â”€ Bed (1)
              â””â”€â”€ Resident (ç‹äº”)
```

### åœºæ™¯3ï¼šå…¬å…±ç©ºé—´ï¼ˆå¤§å…ï¼?
```
Location (ä¸€æ¥¼å¤§å?
  â”œâ”€â”€ is_public_space: true
  â”œâ”€â”€ is_multi_person_room: false
  â””â”€â”€ alert_user_ids: [æŠ¤å£«ç«™å…¨ä½“äººå‘˜]
```

### åœºæ™¯4ï¼šå±…å®¶å…»è€?
```
Location (Home-001)
  â”œâ”€â”€ location_type: HomeCare
  â”œâ”€â”€ primary_resident_id: èµµå…­
  â””â”€â”€ Bed (ä¸»å§åº?
        â””â”€â”€ Resident (èµµå…­)
```

---

## âš ï¸ æ³¨æ„äº‹é¡¹

### åºŠä½å”¯ä¸€æ€?
- ä¸€ä¸ªåºŠä½åªèƒ½åˆ†é…ç»™ä¸€ä¸ªä½æˆ?- æ›´æ–°åºŠä½å…³è”æ—¶éœ€è¦æ£€æŸ?`is_occupied` çŠ¶æ€?- åˆ é™¤åºŠä½å‰éœ€è¦å…ˆè§£é™¤ä½æˆ·å…³è”

### å‘Šè­¦è·¯ç”±

- **å…¬å…±ç©ºé—´**: ä½¿ç”¨ `alert_user_ids` æˆ?`alert_tags` è·¯ç”±
- **ç§äººç©ºé—´**: é€šè¿‡ `resident_caregivers` è¡¨æŸ¥æ‰¾è´Ÿè´£æŠ¤å£?- **å¤šäººæˆ¿é—´**: å¯ä½¿ç”¨è­¦æŠ¥é€šæŠ¥ç»„æˆ–ä½æˆ·æŠ¤å£«çš„å¹¶é›?
### æ•°æ®ä¸€è‡´æ€?
- åˆ é™¤ Location æ—¶éœ€è¦çº§è”åˆ é™?Room å’?Bed
- åˆ é™¤ Room æ—¶éœ€è¦çº§è”åˆ é™?Bed
- åˆ é™¤ Bed æ—¶éœ€è¦è§£é™?Resident å…³è”

---

## ğŸ“– ç›¸å…³æ–‡æ¡£

- æºå‚è€? `owdRD_github_clone_æºå‚è€ƒæ–‡ä»?owlRD/db/04_locations.sql`
- æºå‚è€? `owdRD_github_clone_æºå‚è€ƒæ–‡ä»?owlRD/db/05_rooms.sql`
- æºå‚è€? `owdRD_github_clone_æºå‚è€ƒæ–‡ä»?owlRD/db/06_beds.sql`
- å‘Šè­¦è·¯ç”±: `owdRD_github_clone_æºå‚è€ƒæ–‡ä»?owlRD/README.md` (location-äº?è®¾å¤‡ç»‘å®šè·¯å¾„)
- å®Œæˆåº¦æŠ¥å‘? `é¡¹ç›®è®°å½•/æºå‚è€ƒå¯¹ç…?3-å®Œæˆåº¦æŠ¥å‘?å½“å‰å®Œæˆåº¦æ€»è§ˆ.md`

---

**æœ€åæ›´æ–?*: 2025-11-21  
**ç»´æŠ¤è€?*: AI Assistant
