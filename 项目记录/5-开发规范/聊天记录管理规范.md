# 项目记录自动更新规则

**建立日期**: 2025-11-20  
**适用范围**: 项目记录目录的所有子目录和文件  
**目的**: 规范化记录管理，确保项目历史完整可追溯

---

## 📋 更新规则概述

### 三类记录
1. **过程记录** - 开发阶段的详细报告
2. **聊天记录** - 完整的对话历史
3. **项目状态** - 机器可读的状态信息

---

## 📁 过程记录更新规则

### 触发时机
- 每个Phase/阶段完成时
- 重要功能完成时
- 重大问题解决后
- 项目里程碑节点

### 创建流程
1. **命名格式**: `YYYY-MM-DD_HHMM_Phase名称_简短描述.md`
2. **保存位置**: `项目记录/过程记录/`
3. **内容模板**:

```markdown
# Phase X完成报告: [功能名称]

**完成时间**: YYYY-MM-DD HH:MM
**开发耗时**: 约X分钟
**状态**: ✅ 已完成

---

## 📋 完成内容

### 1. 功能A
- 功能描述
- 实现细节
- 代码量

### 2. 功能B
...

---

## 📊 代码统计
- 新增代码: X行
- 修改文件: X个
- API端点: X个

---

## 🎯 技术亮点
1. 特性1
2. 特性2

---

## ✅ 测试验证
- 测试项1
- 测试项2

---

## 📈 项目进度
- 当前完成度: X%
- 已完成阶段: ...
- 待完成阶段: ...

---

**完成时间**: YYYY-MM-DD HH:MM
**状态**: ✅ 完成
```

### 更新频率
- **主要阶段**: 必须创建报告
- **小功能**: 可合并到阶段报告
- **Bug修复**: 记录在相关阶段报告的更新部分

---

## 💬 聊天记录更新规则

### 触发时机
- 重要对话结束时
- 单次开发会话结束时
- 重大决策讨论后
- 每日开发结束时

### 创建流程
1. **命名格式**: `YYYY-MM-DD_对话主题.md`
2. **保存位置**: `项目记录/聊天记录/`
3. **内容模板**:

```markdown
# YYYY-MM-DD 对话记录: [主题]

**日期**: YYYY-MM-DD
**开始时间**: HH:MM
**结束时间**: HH:MM
**参与者**: [用户名] + [AI名称]

---

## 📋 对话概览

### 主要目标
1. 目标1
2. 目标2

### 完成阶段
- ✅ 阶段1
- ✅ 阶段2

---

## 🗣️ 对话要点

### 1. 主题A（时间）
**用户需求**:
- 需求描述

**完成内容**:
- 完成情况

### 2. 主题B（时间）
...

---

## 📊 成果统计
- 代码量: X行
- 完成度: X%
- 提交次数: X次

---

## 💬 关键对话片段

### 关于[主题]
**用户**: "..."
**AI**: "..."

---

## 🎯 重要决策
1. 决策1 - 理由
2. 决策2 - 理由

---

## 📈 时间线
| 时间 | 事项 | 说明 |
|------|------|------|
| HH:MM | ... | ... |

---

**对话时长**: X小时
**交互次数**: X次
**用户满意度**: ⭐⭐⭐⭐⭐
```

### 更新频率
- **每日开发**: 建议每日创建一份总结
- **长时间对话**: 超过2小时应创建记录
- **重要决策**: 涉及架构/设计决策时必须记录

### 命名建议
- 单日单主题: `2025-11-20_Phase4开发.md`
- 多主题对话: `2025-11-20_完整对话记录.md`
- 特定问题: `2025-11-20_问题排查与解决.md`

---

## 📊 项目状态更新规则

### 触发时机
- 每个Phase完成后
- 代码量显著变化时
- API端点增加时
- 项目完成度变化时

### 更新内容
**文件**: `项目记录/项目状态.json`

**更新字段**:
```json
{
  "last_updated": "YYYY-MM-DDTHH:MM:SS+08:00",
  "current_phase": "Phase X",
  "overall_completion": "X%",
  "phases": {
    "phaseX": {
      "status": "completed",
      "completion": "100%",
      "end_date": "YYYY-MM-DD"
    }
  },
  "code_statistics": {
    "total_lines": X,
    "api_endpoints": X
  },
  "completed_features": [
    "新功能"
  ]
}
```

### 更新方式
1. **手动更新**: 重要节点时手工编辑
2. **脚本更新**: 可编写脚本自动统计代码量
3. **版本控制**: 每次更新提交到Git

---

## 📝 README.md更新规则

### 触发时机
- 目录结构变化时
- 新增记录文件时
- 项目状态变化时
- 完成度更新时

### 更新内容
**文件**: `项目记录/README.md`

**需要更新的部分**:
1. **当前状态**
   - 最后更新时间
   - 当前阶段
   - 记录数量
   - 项目完成度

2. **记录索引**
   - 新增文件路径
   - 按阶段分类
   - 保持格式一致

3. **目录结构**
   - 如有新增目录，更新结构图
   - 保持示例最新

### 更新频率
- **新增记录**: 每次新增记录文件后更新索引
- **状态变化**: 项目状态变化后更新统计
- **定期检查**: 每周检查一次完整性

---

## 🔄 自动化建议

### 可自动化的部分
1. **代码统计**
   ```bash
   # 统计代码行数
   find . -name "*.py" | xargs wc -l
   
   # 统计API端点
   grep -r "@router\." --include="*.py" | wc -l
   ```

2. **文件列表**
   ```bash
   # 生成过程记录列表
   ls -1 项目记录/过程记录/*.md
   ```

3. **Git统计**
   ```bash
   # 提交次数
   git log --oneline | wc -l
   
   # 代码变化量
   git diff --stat
   ```

### 半自动化流程
1. **模板生成**: 使用脚本生成记录模板
2. **内容填充**: 手工填写具体内容
3. **格式检查**: 脚本检查格式规范
4. **索引更新**: 自动更新README索引

### 未来优化
- 开发记录管理CLI工具
- 集成到开发流程中
- 支持Markdown预览
- 自动生成月度/季度报告

---

## ✅ 执行检查清单

### 完成一个Phase后
- [ ] 创建过程记录报告
- [ ] 更新项目状态JSON
- [ ] 更新README索引
- [ ] 提交到Git
- [ ] Push到远程仓库

### 对话结束后
- [ ] 整理对话要点
- [ ] 创建聊天记录
- [ ] 记录重要决策
- [ ] 更新README索引
- [ ] 提交到Git

### 每日结束时
- [ ] 检查所有记录完整性
- [ ] 确认Git提交已push
- [ ] 备份重要文件
- [ ] 计划明日任务

### 每周检查
- [ ] 整理和归档记录
- [ ] 清理过期临时文件
- [ ] 生成周报（可选）
- [ ] 更新项目路线图

---

## 🎯 质量标准

### 过程记录
- ✅ 完整的功能描述
- ✅ 准确的代码统计
- ✅ 清晰的技术说明
- ✅ 详细的测试验证
- ✅ 明确的完成度

### 聊天记录
- ✅ 完整的对话历史
- ✅ 关键需求记录
- ✅ 重要决策说明
- ✅ 问题解决过程
- ✅ 时间线准确

### 项目状态
- ✅ 实时更新
- ✅ 数据准确
- ✅ JSON格式正确
- ✅ 版本控制

---

## 📌 注意事项

### 文件命名
- 使用统一的日期格式
- 避免特殊字符
- 描述简洁明了
- 便于排序和查找

### 内容质量
- 客观记录事实
- 避免主观评价
- 保持格式一致
- 便于后续查阅

### 版本控制
- 及时提交更改
- 写清楚提交信息
- 定期推送远程
- 避免大文件

### 隐私保护
- 不记录敏感信息
- 不包含密码密钥
- 脱敏处理个人信息
- 遵守保密协议

---

## 🔮 未来展望

### 短期（1个月）
- 完善记录模板
- 优化更新流程
- 添加自动化脚本

### 中期（3个月）
- 开发CLI管理工具
- 集成CI/CD流程
- 生成可视化报告

### 长期（6个月）
- 建立知识库系统
- AI辅助记录生成
- 跨项目经验共享

---

**建立时间**: 2025-11-20  
**维护者**: 项目团队  
**版本**: 1.0  
**状态**: ✅ 生效中

---

**说明**: 本规则为建议性规范，可根据项目实际情况灵活调整。重点是保持记录的完整性、准确性和可追溯性。
