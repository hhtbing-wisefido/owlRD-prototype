# æƒé™ç³»ç»Ÿå®ç°å®Œæˆ

**æ—¶é—´**: 2025-11-24 15:20  
**ä»»åŠ¡**: å®Œæ•´å®ç°æºå‚è€ƒä¸­çš„æƒé™è®¾è®¡  
**å‚è€ƒæ–‡æ¡£**: `owdRD_github_clone_æºå‚è€ƒæ–‡ä»¶/docs/24_Card_Permission_Design.md`

---

## ğŸ“‹ å®ç°å†…å®¹

### 1. åç«¯æƒé™æœåŠ¡

#### PermissionService (`backend/app/services/permission_service.py`)

**æ ¸å¿ƒåŠŸèƒ½**:
- âœ… åŠ¨æ€æƒé™è®¡ç®—ï¼ˆä¸åœ¨å¡ç‰‡è¡¨å­˜å‚¨æƒé™ï¼‰
- âœ… åŸºäº`alert_scope`çš„æƒé™è¿‡æ»¤
- âœ… åŸºäºè§’è‰²çš„æƒé™åˆ¤æ–­

**æƒé™çº§åˆ«**:

1. **Adminè§’è‰²**
   - å¯æŸ¥çœ‹ç§Ÿæˆ·ä¸‹æ‰€æœ‰å¡ç‰‡ï¼ˆæ‰€æœ‰å›­åŒºï¼‰
   - æœ€é«˜æƒé™

2. **ALLæƒé™** (`alert_scope = 'ALL'`)
   - Director/NurseManagerè®¾ç½®æ­¤æƒé™
   - å¯æŸ¥çœ‹ç§Ÿæˆ·ä¸‹æ‰€æœ‰å¡ç‰‡

3. **LOCATIONæƒé™** (`alert_scope = 'LOCATION'`)
   - åŸºäº`location_tag`åŒ¹é…`users.tags`
   - åªèƒ½æŸ¥çœ‹åŒ¹é…ä½ç½®æ ‡ç­¾çš„å¡ç‰‡
   - ç¤ºä¾‹ï¼š`location_tag = "Aé™¢åŒºä¸»æ¥¼"`ï¼Œç”¨æˆ·tagsåŒ…å«"Aé™¢åŒºä¸»æ¥¼"

4. **ASSIGNED_ONLYæƒé™** (`alert_scope = 'ASSIGNED_ONLY'`)
   - åŸºäº`resident_caregivers`è¡¨
   - åªèƒ½æŸ¥çœ‹åˆ†é…ç»™è‡ªå·±çš„ä½æˆ·å¡ç‰‡
   - ActiveBedå¡ç‰‡ï¼šæ£€æŸ¥`resident_id`
   - Locationå¡ç‰‡ï¼šæ£€æŸ¥æ˜¯å¦æœ‰åˆ†é…çš„ä½æˆ·åœ¨è¯¥ä½ç½®

**æ ¸å¿ƒæ–¹æ³•**:

```python
# æ£€æŸ¥ç”¨æˆ·æ˜¯å¦æœ‰æƒé™æŸ¥çœ‹å¡ç‰‡
def can_view_card(user_id: UUID, card: Dict) -> bool

# è·å–ç”¨æˆ·å¯è§çš„å¡ç‰‡åˆ—è¡¨
def get_user_cards(user_id: UUID, tenant_id: UUID) -> List[Dict]

# è·å–ä½æˆ·å¯è§çš„å¡ç‰‡åˆ—è¡¨
def get_resident_cards(resident_id: UUID, tenant_id: UUID) -> List[Dict]

# è·å–å®¶å±å¯è§çš„å¡ç‰‡åˆ—è¡¨
def get_family_cards(contact_id: UUID, tenant_id: UUID) -> List[Dict]
```

**ä½æˆ·æƒé™è§„åˆ™**:
- ActiveBedå¡ç‰‡ï¼šè‡ªå·±çš„åºŠä½
- Locationå¡ç‰‡ï¼š
  - æƒ…å†µ1ï¼ˆå•äººå±…ä½ï¼‰ï¼šè¯¥location_idä¸‹ä½æˆ·å”¯ä¸€
  - æƒ…å†µ2ï¼ˆå¤«å¦»åŒä½ï¼‰ï¼šæ‰€æœ‰ä½æˆ·ä½¿ç”¨ç›¸åŒçš„`family_tag`
  - ä¸æ”¯æŒå¤šäººåˆç§Ÿåœºæ™¯

**å®¶å±æƒé™è§„åˆ™**:
- é€šè¿‡`resident_contacts`è¡¨å…³è”ä½æˆ·
- éœ€æ»¡è¶³ï¼š`can_view_status=TRUE` ä¸” `is_active=TRUE`
- æƒé™ä¸å…³è”ä½æˆ·å®Œå…¨ç›¸åŒ
- ä¸€ä¸ªå®¶å±å¯ä»¥å…³è”å¤šä¸ªä½æˆ·

---

### 2. è®¤è¯ä¾èµ–é¡¹

#### AuthDependency (`backend/app/dependencies/auth.py`)

**åŠŸèƒ½**:
- âœ… ä»Authorization headeræå–JWT token
- âœ… éªŒè¯tokenæœ‰æ•ˆæ€§
- âœ… è¿”å›å½“å‰ç”¨æˆ·ä¿¡æ¯
- âœ… æ£€æŸ¥ç”¨æˆ·æ¿€æ´»çŠ¶æ€

**ä½¿ç”¨æ–¹å¼**:

```python
from app.dependencies.auth import get_current_user_from_token, require_admin

# æ™®é€šè®¤è¯
@router.get("/cards/")
async def list_cards(
    current_user: Dict = Depends(get_current_user_from_token)
):
    user_id = current_user["user_id"]
    # ...

# è¦æ±‚Adminè§’è‰²
@router.delete("/cards/{card_id}")
async def delete_card(
    card_id: UUID,
    current_user: Dict = Depends(require_admin())
):
    # åªæœ‰Adminå¯ä»¥æ‰§è¡Œ
```

---

### 3. å¡ç‰‡APIæƒé™é›†æˆ

#### æ›´æ–°çš„ç«¯ç‚¹ (`backend/app/api/v1/cards.py`)

**`GET /api/v1/cards/`** - è·å–å¡ç‰‡åˆ—è¡¨ï¼ˆå¸¦æƒé™è¿‡æ»¤ï¼‰

**æƒé™è§„åˆ™**:
- Adminè§’è‰²ï¼šçœ‹æ‰€æœ‰å¡ç‰‡
- alert_scope=ALLï¼šçœ‹æ‰€æœ‰å¡ç‰‡
- alert_scope=LOCATIONï¼šåªçœ‹åŒ¹é…location_tagçš„å¡ç‰‡
- alert_scope=ASSIGNED_ONLYï¼šåªçœ‹åˆ†é…çš„ä½æˆ·å¡ç‰‡

**å˜æ›´**:
```python
# ä¹‹å‰ï¼šè¿”å›æ‰€æœ‰å¡ç‰‡
cards = await card_manager.search_cards(tenant_id=tenant_id)

# ç°åœ¨ï¼šæ ¹æ®æƒé™è¿‡æ»¤
permission_service = get_permission_service()
cards = permission_service.get_user_cards(user_id, tenant_id)
```

**`GET /api/v1/cards/{card_id}`** - è·å–å•ä¸ªå¡ç‰‡ï¼ˆå¸¦æƒé™æ£€æŸ¥ï¼‰

**æƒé™è§„åˆ™**:
- æ£€æŸ¥ç”¨æˆ·æ˜¯å¦æœ‰æƒæŸ¥çœ‹è¯¥å¡ç‰‡
- æ— æƒé™è¿”å›403 Forbidden

---

### 4. å‰ç«¯æƒé™Hook

#### usePermissions (`frontend/src/hooks/usePermissions.ts`)

**åŠŸèƒ½**:
- âœ… è·å–å½“å‰ç”¨æˆ·ä¿¡æ¯
- âœ… åˆ¤æ–­è§’è‰²æƒé™
- âœ… åˆ¤æ–­æ“ä½œæƒé™
- âœ… æä¾›è¾…åŠ©å‡½æ•°

**ä½¿ç”¨ç¤ºä¾‹**:

```typescript
import { usePermissions } from '../hooks/usePermissions'

function MyComponent() {
  const {
    isAdmin,
    canViewAllCards,
    canEditCard,
    canDeleteCard,
    user,
    alertScope
  } = usePermissions()

  return (
    <div>
      {canViewAllCards && <AllCardsView />}
      {canEditCard && <EditButton />}
      {canDeleteCard && <DeleteButton />}
      <p>å½“å‰ç”¨æˆ·: {user?.username}</p>
      <p>æƒé™èŒƒå›´: {alertScope}</p>
    </div>
  )
}
```

**æƒé™åˆ¤æ–­å±æ€§**:

```typescript
interface PermissionResult {
  // è§’è‰²åˆ¤æ–­
  isAdmin: boolean
  isDirector: boolean
  isNurseManager: boolean
  isNurse: boolean
  isCaregiver: boolean
  
  // æ•°æ®æŸ¥çœ‹æƒé™
  canViewAllCards: boolean
  canViewLocationCards: boolean
  canViewAssignedCards: boolean
  
  // æ“ä½œæƒé™
  canCreateCard: boolean
  canEditCard: boolean
  canDeleteCard: boolean
  canManageUsers: boolean
  canManageRoles: boolean
  canManageDevices: boolean
  canManageLocations: boolean
  canManageResidents: boolean
  canViewAlerts: boolean
  canManageAlertPolicies: boolean
  
  // åŸå§‹æ•°æ®
  user: User | null
  alertScope: string
}
```

**è¾…åŠ©å‡½æ•°**:

```typescript
// è·å–è®¤è¯ä»¤ç‰Œ
getAuthToken(): string | null

// è·å–å½“å‰ç”¨æˆ·ID
getCurrentUserId(): string | null

// è·å–å½“å‰ç§Ÿæˆ·ID
getCurrentTenantId(): string | null

// æ£€æŸ¥æ˜¯å¦å·²ç™»å½•
isAuthenticated(): boolean
```

---

### 5. æƒé™å®ˆå«ç»„ä»¶

#### PermissionGuard (`frontend/src/components/PermissionGuard.tsx`)

**åŠŸèƒ½**:
- âœ… åŸºäºæƒé™æ¡ä»¶æ¸²æŸ“ç»„ä»¶
- âœ… æ”¯æŒè‡ªå®šä¹‰fallback
- âœ… æ”¯æŒå‡½æ•°å¼æƒé™åˆ¤æ–­

**ä½¿ç”¨ç¤ºä¾‹**:

```tsx
import PermissionGuard from '../components/PermissionGuard'

// ç®€å•æƒé™æ£€æŸ¥
<PermissionGuard requires="canEditCard">
  <EditButton />
</PermissionGuard>

// å¸¦fallback
<PermissionGuard 
  requires="canDeleteCard"
  fallback={<div>æ‚¨æ²¡æœ‰åˆ é™¤æƒé™</div>}
>
  <DeleteButton />
</PermissionGuard>

// è‡ªå®šä¹‰å‡½æ•°åˆ¤æ–­
<PermissionGuard 
  requires={(perms) => perms.isAdmin || perms.isDirector}
>
  <AdminPanel />
</PermissionGuard>

// å¤šæ¡ä»¶ç»„åˆ
<PermissionGuard 
  requires={(perms) => 
    perms.canViewAllCards && perms.user?.is_active
  }
>
  <Dashboard />
</PermissionGuard>
```

---

### 6. APIæœåŠ¡è‡ªåŠ¨è®¤è¯

#### APIæ‹¦æˆªå™¨ (`frontend/src/services/api.ts`)

**åŠŸèƒ½**:
- âœ… è‡ªåŠ¨ä»localStorageè·å–token
- âœ… è‡ªåŠ¨æ·»åŠ Authorization header
- âœ… æ‰€æœ‰APIè¯·æ±‚è‡ªåŠ¨æºå¸¦è®¤è¯ä¿¡æ¯

**å®ç°**:

```typescript
api.interceptors.request.use(
  (config) => {
    const token = localStorage.getItem('token')
    if (token) {
      config.headers.Authorization = `Bearer ${token}`
    }
    return config
  }
)
```

**ä½¿ç”¨æ•ˆæœ**:
```typescript
// å¼€å‘è€…æ— éœ€æ‰‹åŠ¨æ·»åŠ token
const response = await api.get('/api/v1/cards/')
// æ‹¦æˆªå™¨è‡ªåŠ¨æ·»åŠ : Authorization: Bearer <token>
```

---

## ğŸ¯ æƒé™ç³»ç»Ÿæ¶æ„å›¾

```
å‰ç«¯                          åç«¯
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç”¨æˆ·ç™»å½•       â”‚â”€â”€tokenâ”€â”€>â”‚  JWTè®¤è¯             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                      â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  usePermissions â”‚          â”‚  AuthDependency      â”‚
â”‚  - è§’è‰²åˆ¤æ–­     â”‚          â”‚  - éªŒè¯token         â”‚
â”‚  - æƒé™åˆ¤æ–­     â”‚          â”‚  - è·å–ç”¨æˆ·ä¿¡æ¯      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚                             â”‚
        â–¼                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ PermissionGuard â”‚          â”‚  PermissionService   â”‚
â”‚  - æ¡ä»¶æ¸²æŸ“     â”‚          â”‚  - can_view_card     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚  - get_user_cards    â”‚
                             â”‚  - get_resident_cardsâ”‚
                             â”‚  - get_family_cards  â”‚
                             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                      â”‚
                             â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                             â”‚  æƒé™è®¡ç®—é€»è¾‘        â”‚
                             â”‚  - Admin: å…¨éƒ¨       â”‚
                             â”‚  - ALL: å…¨éƒ¨         â”‚
                             â”‚  - LOCATION: æ ‡ç­¾åŒ¹é…â”‚
                             â”‚  - ASSIGNED: åˆ†é…ä½æˆ·â”‚
                             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“ æƒé™çŸ©é˜µ

### è§’è‰²ä¸alert_scopeç»„åˆ

| è§’è‰² | é»˜è®¤alert_scope | å¯è§èŒƒå›´ | æ“ä½œæƒé™ |
|------|----------------|----------|----------|
| **Admin** | - | ç§Ÿæˆ·æ‰€æœ‰æ•°æ® | å…¨éƒ¨æ“ä½œ |
| **Director** | ALL | ç§Ÿæˆ·æ‰€æœ‰æ•°æ® | ç®¡ç†ç”¨æˆ·ã€ä½ç½®ã€ä½æˆ· |
| **NurseManager** | LOCATION | åŒ¹é…æ ‡ç­¾çš„æ•°æ® | ç®¡ç†è®¾å¤‡ã€ä½æˆ·ã€å‘Šè­¦ |
| **Nurse** | LOCATION | åŒ¹é…æ ‡ç­¾çš„æ•°æ® | æŸ¥çœ‹ã€è®°å½•æŠ¤ç† |
| **Caregiver** | ASSIGNED_ONLY | åˆ†é…çš„ä½æˆ· | æŸ¥çœ‹ã€è®°å½•æŠ¤ç† |

### æ“ä½œæƒé™è¯¦ç»†

| æ“ä½œ | Admin | Director | NurseManager | Nurse | Caregiver |
|------|-------|----------|--------------|-------|-----------|
| æŸ¥çœ‹æ‰€æœ‰å¡ç‰‡ | âœ… | âœ… | âŒ | âŒ | âŒ |
| æŸ¥çœ‹ä½ç½®å¡ç‰‡ | âœ… | âœ… | âœ… | âœ… | âŒ |
| æŸ¥çœ‹åˆ†é…å¡ç‰‡ | âœ… | âœ… | âœ… | âœ… | âœ… |
| åˆ›å»ºå¡ç‰‡ | âœ… | âœ… | âœ… | âŒ | âŒ |
| ç¼–è¾‘å¡ç‰‡ | âœ… | âœ… | âœ… | âŒ | âŒ |
| åˆ é™¤å¡ç‰‡ | âœ… | âŒ | âŒ | âŒ | âŒ |
| ç®¡ç†ç”¨æˆ· | âœ… | âœ… | âŒ | âŒ | âŒ |
| ç®¡ç†è§’è‰² | âœ… | âŒ | âŒ | âŒ | âŒ |
| ç®¡ç†è®¾å¤‡ | âœ… | âœ… | âœ… | âŒ | âŒ |
| ç®¡ç†ä½ç½® | âœ… | âœ… | âŒ | âŒ | âŒ |
| ç®¡ç†ä½æˆ· | âœ… | âœ… | âœ… | âŒ | âŒ |
| æŸ¥çœ‹å‘Šè­¦ | âœ… | âœ… | âœ… | âœ… | âœ… |
| ç®¡ç†å‘Šè­¦ç­–ç•¥ | âœ… | âœ… | âœ… | âŒ | âŒ |

---

## ğŸ”§ ä½¿ç”¨æŒ‡å—

### åç«¯APIå¼€å‘

**æ·»åŠ æƒé™æ£€æŸ¥åˆ°APIç«¯ç‚¹**:

```python
from fastapi import Depends
from app.dependencies.auth import get_current_user_from_token
from app.services.permission_service import get_permission_service

@router.get("/my-resource/")
async def list_resources(
    tenant_id: UUID,
    current_user: Dict = Depends(get_current_user_from_token)
):
    # 1. éªŒè¯ç§Ÿæˆ·æƒé™
    if str(current_user["tenant_id"]) != str(tenant_id):
        raise HTTPException(403, detail="æ— æƒè®¿é—®å…¶ä»–ç§Ÿæˆ·æ•°æ®")
    
    # 2. ä½¿ç”¨æƒé™æœåŠ¡è¿‡æ»¤æ•°æ®
    permission_service = get_permission_service()
    user_id = current_user["user_id"]
    
    # æ ¹æ®ä¸šåŠ¡é€»è¾‘å®ç°æƒé™è¿‡æ»¤
    # ...
```

### å‰ç«¯ç»„ä»¶å¼€å‘

**åœ¨ç»„ä»¶ä¸­ä½¿ç”¨æƒé™**:

```tsx
import { usePermissions } from '../hooks/usePermissions'
import PermissionGuard from '../components/PermissionGuard'

function CardManagement() {
  const { canEditCard, canDeleteCard, isAdmin } = usePermissions()

  return (
    <div>
      {/* æ–¹å¼1: æ¡ä»¶æ¸²æŸ“ */}
      {canEditCard && (
        <button onClick={handleEdit}>ç¼–è¾‘</button>
      )}

      {/* æ–¹å¼2: æƒé™å®ˆå«ç»„ä»¶ */}
      <PermissionGuard requires="canDeleteCard">
        <button onClick={handleDelete}>åˆ é™¤</button>
      </PermissionGuard>

      {/* æ–¹å¼3: å¤æ‚æ¡ä»¶ */}
      <PermissionGuard 
        requires={(p) => p.isAdmin || p.canManageLocations}
      >
        <AdminPanel />
      </PermissionGuard>
    </div>
  )
}
```

---

## âœ… å®Œæˆçš„åŠŸèƒ½

- [x] åç«¯æƒé™æœåŠ¡ï¼ˆPermissionServiceï¼‰
- [x] åŠ¨æ€æƒé™è®¡ç®—ï¼ˆåŸºäºalert_scopeï¼‰
- [x] Admin/ALL/LOCATION/ASSIGNED_ONLYå››çº§æƒé™
- [x] ä½æˆ·æƒé™ï¼ˆå•äºº/å¤«å¦»åŒä½ï¼‰
- [x] å®¶å±æƒé™ï¼ˆåŸºäºresident_contactsï¼‰
- [x] è®¤è¯ä¾èµ–é¡¹ï¼ˆJWTéªŒè¯ï¼‰
- [x] å¡ç‰‡APIæƒé™é›†æˆ
- [x] å‰ç«¯æƒé™Hookï¼ˆusePermissionsï¼‰
- [x] å‰ç«¯æƒé™å®ˆå«ç»„ä»¶ï¼ˆPermissionGuardï¼‰
- [x] APIè‡ªåŠ¨è®¤è¯ï¼ˆAuthorization headerï¼‰

---

## ğŸš€ ä¸‹ä¸€æ­¥è®¡åˆ’

### å¾…å®ç°åŠŸèƒ½

1. **å…¶ä»–APIç«¯ç‚¹æƒé™é›†æˆ**
   - [ ] ä½æˆ·ç®¡ç†API
   - [ ] è®¾å¤‡ç®¡ç†API
   - [ ] ä½ç½®ç®¡ç†API
   - [ ] å‘Šè­¦ç®¡ç†API
   - [ ] ç”¨æˆ·ç®¡ç†API

2. **å‰ç«¯é¡µé¢æƒé™åº”ç”¨**
   - [ ] å¡ç‰‡ç®¡ç†é¡µé¢æ·»åŠ æƒé™æ§åˆ¶
   - [ ] ç”¨æˆ·ç®¡ç†é¡µé¢æ·»åŠ æƒé™æ§åˆ¶
   - [ ] å¯¼èˆªèœå•æ ¹æ®æƒé™æ˜¾ç¤º/éšè—

3. **æƒé™é…ç½®ç•Œé¢**
   - [ ] ç”¨æˆ·æƒé™ç¼–è¾‘ç•Œé¢
   - [ ] alert_scopeè®¾ç½®ç•Œé¢
   - [ ] tagsé…ç½®ç•Œé¢

4. **æµ‹è¯•**
   - [ ] æƒé™æœåŠ¡å•å…ƒæµ‹è¯•
   - [ ] APIæƒé™é›†æˆæµ‹è¯•
   - [ ] å‰ç«¯æƒé™ç»„ä»¶æµ‹è¯•

---

## ğŸ“Š ä»£ç ç»Ÿè®¡

| æ–‡ä»¶ | è¡Œæ•° | è¯´æ˜ |
|------|------|------|
| `backend/app/services/permission_service.py` | 373 | æƒé™æœåŠ¡æ ¸å¿ƒ |
| `backend/app/dependencies/auth.py` | 118 | è®¤è¯ä¾èµ– |
| `backend/app/api/v1/cards.py` | +56 | å¡ç‰‡APIæ›´æ–° |
| `frontend/src/hooks/usePermissions.ts` | 195 | æƒé™Hook |
| `frontend/src/components/PermissionGuard.tsx` | 44 | æƒé™å®ˆå« |
| `frontend/src/services/api.ts` | +5 | APIæ‹¦æˆªå™¨ |
| **æ€»è®¡** | **791** | æ–°å¢ä»£ç  |

---

## ğŸ“š å‚è€ƒæ–‡æ¡£

- æºå‚è€ƒè®¾è®¡ï¼š`owdRD_github_clone_æºå‚è€ƒæ–‡ä»¶/docs/24_Card_Permission_Design.md`
- ç›¸å…³è¡¨ç»“æ„ï¼š
  - `users` - ç”¨æˆ·è¡¨ï¼ˆrole, alert_scope, tagsï¼‰
  - `locations` - ä½ç½®è¡¨ï¼ˆlocation_tagï¼‰
  - `resident_caregivers` - ä½æˆ·åˆ†é…è¡¨
  - `resident_contacts` - å®¶å±å…³è”è¡¨

---

## ğŸ‰ æˆæœ

âœ… **å®Œæ•´å®ç°äº†æºå‚è€ƒæ–‡æ¡£ä¸­çš„æƒé™è®¾è®¡**

- åŠ¨æ€æƒé™è®¡ç®—ï¼Œä¸åœ¨å¡ç‰‡è¡¨å­˜å‚¨æƒé™
- åŸºäºalert_scopeçš„å››çº§æƒé™ä½“ç³»
- ä½æˆ·å’Œå®¶å±æƒé™å®Œæ•´å®ç°
- å‰åç«¯æƒé™ç³»ç»Ÿå®Œæ•´é›†æˆ
- å¼€ç®±å³ç”¨çš„æƒé™Hookå’Œç»„ä»¶

**æ€»ä»£ç é‡**: 791è¡Œ  
**Gitæäº¤**: `3dedd5e - feat: å®ç°å®Œæ•´çš„æƒé™ç³»ç»Ÿ(åŸºäºalert_scopeå’Œrole)`
