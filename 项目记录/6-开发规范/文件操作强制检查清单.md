# 文件操作强制检查清单

**目的**: 防止乱建文件、乱建目录，确保所有文件操作符合规范

---

## ⚠️ 强制执行规则

**每次创建/移动/删除文件前，必须完成以下检查：**

### 创建新文件前的5步检查

#### 步骤1: 检查是否已存在类似文件
```bash
# 在所有项目记录目录搜索关键词
grep -r "关键词" 项目记录/
```

**必须回答**:
- [ ] 是否有文件名相似的？
- [ ] 是否有内容重复的？
- [ ] 是否有功能重叠的？

#### 步骤2: 确认应该放在哪个目录
```
项目记录/
├── 1-归档/           ← 过时文档
├── 2-源参考对照/     ← Schema对照、完成度报告
├── 3-功能说明/       ← 功能详细说明文档
├── 4-部署运维/       ← 部署配置文档
├── 5-问题分析/       ← 问题报告和分析
├── 6-开发规范/       ← 开发规范（本文件所在）
├── 7-过程记录/       ← 按时间的开发记录
└── 8-聊天记录/       ← AI对话记录
```

**必须回答**:
- [ ] 文件应该放在哪个目录？
- [ ] 为什么放在这个目录？

#### 步骤3: 按规范命名
```
命名规则：
- 规范类: [主题]规范.md
- 说明类: [主题]说明.md
- 指南类: [主题]指南.md
- 记录类: YYYY-MM-DD_[描述].md
- 报告类: YYYY-MM-DD_[主题]报告.md
```

**必须回答**:
- [ ] 文件名是否清晰具体？
- [ ] 是否避免了模糊名称？
- [ ] 是否会与现有文件混淆？

#### 步骤4: 检查目录结构
```bash
# 列出目标目录现有文件
ls -la "目标目录/"
```

**必须回答**:
- [ ] 目标目录是否存在？
- [ ] 是否需要创建新目录？
- [ ] 新目录是否符合规范？

#### 步骤5: 更新索引和引用
**必须更新**:
- [ ] `项目记录/README.md` - 添加新文件到索引
- [ ] 相关文档的交叉引用
- [ ] `项目状态.json` (如果是重要文件)

---

## 🔍 项目遍历检查清单

### 每次大的变动后必须执行

#### 1. 检查文件重复
```bash
# 找出相似文件名
find 项目记录/ -name "*.md" | sort

# 检查内容相似度（手动对比）
# - 比较文件大小
# - 比较创建时间
# - 抽查文件内容
```

**检查项**:
- [ ] 是否有文件名高度相似？
- [ ] 是否有内容大量重复？
- [ ] 是否有功能完全重叠？

#### 2. 检查文件过时
**过时文件特征**:
- 创建时间超过1个月且未更新
- 内容被新文件替代
- 功能已废弃

**处理方式**:
- [ ] 确认文件是否过时
- [ ] 移动到 `1-归档/` 目录
- [ ] 在归档文件中注明"被XXX替代"
- [ ] 从README索引中移除

#### 3. 检查目录结构规范
```bash
# 检查目录是否符合8大分类
ls -d 项目记录/*/
```

**必须符合**:
- [ ] 所有目录都在8大分类中
- [ ] 没有随意创建的新目录
- [ ] 目录命名符合规范

#### 4. 检查文件对齐
**对齐检查**:
- [ ] 移动文件后，旧位置的引用是否更新？
- [ ] README索引是否更新？
- [ ] 其他文档的交叉引用是否正确？
- [ ] 相关脚本路径是否更新？

#### 5. 检查文档完整性
**必须检查**:
- [ ] 每个功能是否有对应说明文档？
- [ ] 说明文档是否在正确目录？
- [ ] 文档是否被正确索引？
- [ ] 文档版本是否一致？

---

## 📋 强制执行的操作模板

### 创建新文件
```
1. 检查现有文件: ls 项目记录/**/*.md | grep "关键词"
2. 确认目录: 应该放在 [X-目录名]
3. 确认文件名: [符合规范的文件名].md
4. 创建文件: write_to_file
5. 更新README: 添加到索引
6. Git提交: 包含README更新
```

### 移动文件
```
1. 记录旧路径和新路径
2. 搜索所有引用: grep -r "旧文件名" 项目记录/
3. 移动文件: Move-Item
4. 更新所有引用处
5. 更新README索引
6. Git提交: 说明移动原因
```

### 删除文件
```
1. 确认文件确实应该删除
2. 搜索所有引用: grep -r "文件名" 项目记录/
3. 如果有价值，先移动到归档
4. 删除所有引用
5. 更新README索引
6. Git提交: 说明删除原因
```

---

## 🚫 禁止的操作

### 严格禁止以下行为

❌ **禁止随意创建文件**
- 未检查是否已存在
- 未确认应该放在哪个目录
- 文件名不符合规范

❌ **禁止随意创建目录**
- 未确认是否必要
- 不在8大分类中
- 未在README中说明

❌ **禁止不更新引用**
- 移动文件后不更新引用
- 重命名后不更新索引
- 删除后不清理引用

❌ **禁止不对齐相关内容**
- 更新文档不同步其他文档
- 改变目录结构不更新脚本
- 修改功能不更新说明

---

## ✅ 正确的工作流程

### 示例：添加一个新功能说明文档

```
步骤1: 搜索现有文件
$ find 项目记录/ -name "*房间*.md"
结果: 发现 "位置房间床位管理说明.md"

步骤2: 判断是否需要新文件
问：新内容是否可以添加到现有文件？
答：是，可以补充到现有文件

步骤3: 编辑现有文件
使用 edit 工具补充内容

步骤4: 更新相关引用
检查是否需要更新其他文档

步骤5: Git提交
提交说明要清晰
```

---

## 🔄 定期检查任务

### 每周检查
- [ ] 遍历所有.md文件，检查是否有重复
- [ ] 检查README索引是否完整
- [ ] 检查是否有过时文件需要归档

### 每次大更新后检查
- [ ] 所有文件路径是否正确
- [ ] 所有引用是否有效
- [ ] 所有索引是否更新
- [ ] 项目状态.json是否更新

---

## 📝 检查记录模板

```markdown
## [YYYY-MM-DD] 文件操作检查记录

### 本次操作
- 操作类型: [创建/移动/删除]
- 文件路径: [完整路径]
- 操作原因: [说明]

### 检查清单
- [x] 步骤1: 检查现有文件
- [x] 步骤2: 确认目录位置
- [x] 步骤3: 确认文件名
- [x] 步骤4: 更新索引
- [x] 步骤5: 更新引用

### 相关更新
- README.md: [更新内容]
- 其他文件: [列出更新的文件]

### Git提交
- Commit ID: [hash]
- 提交说明: [message]
```

---

## 🎯 强制执行承诺

**从现在开始，我保证：**

1. ✅ 每次创建文件前，完成5步检查
2. ✅ 每次移动文件后，更新所有引用
3. ✅ 每次删除文件前，确认无引用
4. ✅ 每次变动后，更新README索引
5. ✅ 定期执行项目遍历检查

**如果违反，立即停止并修正！**

---

**建立时间**: 2024-11-24  
**强制执行**: 立即生效  
**检查频率**: 每次文件操作前必查  
**责任**: AI助手自查自纠
