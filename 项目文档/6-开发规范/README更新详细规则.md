# README.md 更新详细规则

**规则类别**: 强制执行  
**适用范围**: 所有文件的创建、修改、删除、重命名操作  
**优先�?*: 🔴 �? 
**来源规则**: 05-change-synchronization.md + 01-file-operations.md  
**创建日期**: 2025-11-26  

---

## 📋 目录

- [核心原则](#核心原则)
- [何时需要更新README](#何时需要更新readme)
- [更新规则详解](#更新规则详解)
  - [场景1: 创建新文件](#场景1-创建新文�?
  - [场景2: 修改文件内容](#场景2-修改文件内容)
  - [场景3: 删除文件](#场景3-删除文件)
  - [场景4: 重命名文件](#场景4-重命名文�?
  - [场景5: 移动文件](#场景5-移动文件)
- [操作步骤](#操作步骤)
- [检查清单](#检查清�?
- [常见错误](#常见错误)

---

## 🎯 核心原则

### 变更必须同步

```
文件变更 �?README索引更新 �?引用更新 �?验证完成
```

### 三大核心理念

1. **📚 文档是代码的一部分**
   - 修改文件 = 必须修改README
   - 不更新README = 不完整的工作

2. **🔍 可发现性优�?*
   - README是项目的导航地图
   - 新文件必须能被找�?
   - 删除的文件必须移除引�?

3. **�?保持一致�?*
   - 文件系统与README索引必须一�?
   - 所有引用必须有�?
   - 描述必须准确

---

## 📚 何时需要更新README

### 必须更新的情�?

| 操作 | 是否更新 | 更新内容 | 规则来源 |
|------|---------|---------|----------|
| **🆕 创建新文�?* | �?必须 | 添加到索�?| 01-file-operations.md 步骤5 |
| **✏️ 修改文件内容** | ⚠️ 视情�?| 更新描述（如有变化） | 05-change-synchronization.md |
| **�?删除文件** | �?必须 | 从索引移�?| 05-change-synchronization.md |
| **📝 重命名文�?* | �?必须 | 更新索引和引�?| 05-change-synchronization.md |
| **📁 移动文件** | �?必须 | 更新路径和索�?| 05-change-synchronization.md |
| **🆕 创建目录** | �?必须 | 父目录README + 新目录README | 01-file-operations.md |
| **📝 修改标题** | �?必须 | 更新索引描述 | 05-change-synchronization.md |

### 不需要更新的情况

| 操作 | 说明 |
|------|------|
| **💄 样式调整** | 不影响内容和功能 |
| **🐛 修复拼写错误** | 不影响文件主题和用�?|
| **📝 添加注释** | 内部代码注释，不影响使用 |
| **♻️ 重构代码** | API和使用方式未变化 |

---

## 📖 更新规则详解

### 场景1: 创建新文�?

**规则来源**: `01-file-operations.md` - 步骤5: 准备更新项目索引

#### 1.1 在文档目录创建文�?

**触发条件**:
- �?`项目文档/` 下创建任何新�?md文件
- �?`知识�?` 下创建新文档
- 在任何有README.md的目录下创建文档

**必须更新**:
```markdown
# [文档目录]/README.md

## 📋 文件列表

### [分类名称]
- [新文件名](新文件名.md) - 简短描�? �?新增这一�?
```

**示例**:
```markdown
# 项目文档/3-功能说明/README.md

## 📋 功能说明文档

### 核心功能
- [用户认证功能说明](用户认证功能说明.md) - 用户登录、注册、权限管�? �?新增
- [数据处理功能说明](数据处理功能说明.md) - 数据导入、导出、转�?
```

---

#### 1.2 创建重要代码文件

**触发条件**:
- 创建新的模块文件
- 创建新的API端点
- 创建新的工具脚本

**必须更新**:

1. **对应目录的README.md**
   ```markdown
   # src/modules/README.md
   
   ## 模块列表
   
   - `auth.py` - 用户认证模块  �?新增
   - `database.py` - 数据库连接模�?
   ```

2. **项目根目录README.md**（如果是新功能）
   ```markdown
   # README.md
   
   ## 功能特�?
   
   - �?用户认证系统  �?新增
   - �?数据持久�?
   ```

3. **项目状态文�?*（如适用�?
   ```json
   {
     "modules": [
       "auth",  �?新增
       "database"
     ]
   }
   ```

---

#### 1.3 创建新的子目�?

**触发条件**:
- 创建了新的子目录

**必须更新**:

1. **父目录的README.md**
   ```markdown
   # 项目文档/README.md
   
   ## 📁 目录结构
   
   - 📁 `9-新分�?` - 新分类的说明  �?新增这一�?
     - 用于存放xxx类型的文�?
   ```

2. **新目录中创建README.md**
   ```markdown
   # 9-新分�?README.md
   
   # 新分�?
   
   ## 📖 目录说明
   
   本目录用于存�?..
   
   ## 📋 文件列表
   
   （暂无文件）
   ```

---

### 场景2: 修改文件内容

**规则来源**: `05-change-synchronization.md` - 修改文件后的同步要求

#### 2.1 修改功能代码

**触发条件**:
- 修改了函数签�?
- 修改了API接口
- 修改了使用方�?
- 添加了新功能

**必须更新**:

1. **README.md的使用说�?*
   ```markdown
   # 旧README（需要更新）
   ## 使用方法
   process_data(data)
   
   # 新README（已更新�?
   ## 使用方法
   process_data(data, format="json")  # 新增format参数
   ```

2. **API文档**
   - 更新参数说明
   - 更新示例代码
   - 更新返回值说�?

3. **CHANGELOG.md**
   ```markdown
   ## [Unreleased]
   ### Changed
   - `process_data()` 新增 `format` 参数，支持JSON和XML输出
   ```

---

#### 2.2 修改配置文件

**触发条件**:
- 修改了配置项
- 修改了默认�?
- 添加了新配置

**必须更新**:

1. **README.md的配置说明部�?*
   ```markdown
   # README.md
   
   ## ⚙️ 配置
   
   ### database.host
   - 默认�? `127.0.0.1` （之前是 localhost�? �?更新
   - 说明: 数据库地址
   ```

2. **配置示例文件**
   ```yaml
   # config.example.yml
   database:
     host: "127.0.0.1"  # 已更新默认�?
   ```

---

#### 2.3 修改文档内容

**触发条件**:
- 修改了文档的主题或用�?
- 修改了文档的标题

**必须更新**:

1. **父目录README索引**
   ```markdown
   # 旧索�?
   - [部署指南](deployment.md) - 如何部署应用
   
   # 新索引（如果修改了文档主题）
   - [部署指南](deployment.md) - Docker和K8s部署方法（已更新�?
   ```

2. **相关引用**
   - 检查其他文档中的链�?
   - 检查代码注释中的引�?

---

### 场景3: 删除文件

**规则来源**: `05-change-synchronization.md` - 删除文件后的同步要求

#### 必须执行�?步操�?

**步骤1: 从README索引中移�?* �?

```markdown
# 删除�?
- [旧功能说明](old-feature.md)
- [新功能说明](new-feature.md)

# 删除�?
- [新功能说明](new-feature.md)  # 已移除旧功能
```

**步骤2: 检查并更新所有引�?* �?

**搜索命令**:
```bash
# 搜索文档引用
grep -r "old-feature" .

# 搜索代码引用
grep -r "old_feature" src/
```

**更新引用**:
- 移除失效链接
- 添加替代说明（如有）
- 或添�?已废�?标记

**步骤3: 更新相关文档** �?

如果删除的文件是某个流程的一部分�?
```markdown
# 流程文档需要更�?

旧流�?
1. 配置环境
2. 运行old-feature  �?需要删�?
3. 验证结果

新流�?
1. 配置环境
2. 验证结果  �?流程简�?
```

**步骤4: 添加删除说明** �?

在CHANGELOG.md中记�?
```markdown
## [Unreleased]
### Removed
- 移除 `old-feature.md` - 功能已合并到 `new-feature.md`
```

---

### 场景4: 重命名文�?

**规则来源**: `05-change-synchronization.md` - 重命名文件后的同步要�?

#### 必须执行�?步操�?

**步骤1: 使用Git rename保留历史** �?

```bash
# 正确做法
git mv old-name.md new-name.md

# 错误做法（会丢失历史�?
rm old-name.md
create new-name.md
```

**步骤2: 全局搜索更新引用** �?

**文档引用**:
```bash
# 搜索Markdown链接
grep -r "old-name.md" .

# 搜索文件�?
grep -r "old-name" docs/
```

**代码引用**:
```bash
# 搜索import语句
grep -r "old_name" src/

# 搜索配置引用
grep -r "old-name" config/
```

**步骤3: 更新README索引** �?

```markdown
# 旧索�?
- [旧文件名](old-name.md) - 功能说明

# 新索�?
- [新文件名](new-name.md) - 功能说明  # 路径和名称都更新
```

**步骤4: 更新项目配置** �?

```json
{
  "files": [
    "new-name.md"  // 之前�?"old-name.md"
  ]
}
```

---

### 场景5: 移动文件

**规则来源**: `05-change-synchronization.md` - 重命名文件后的同步要�?

#### 必须执行的操�?

**步骤1: 使用Git移动** �?

```bash
git mv src/old-location/file.md docs/new-location/file.md
```

**步骤2: 更新原目录README** �?

```markdown
# src/old-location/README.md

# 移除该文件的索引
- ~~[文件名](file.md)~~ - 已移动到 docs/new-location/
```

**步骤3: 更新新目录README** �?

```markdown
# docs/new-location/README.md

# 添加该文件到索引
- [文件名](file.md) - 功能说明  �?新增
```

**步骤4: 全局更新引用** �?

- 更新所有Markdown链接
- 更新代码中的路径引用
- 更新配置文件

---

## 🔧 操作步骤

### 标准更新流程

```
步骤1: 执行文件操作（创�?修改/删除/重命名）
    �?
步骤2: 确定需要更新的README.md
    ├─ 文件所在目录的README.md
    ├─ 父目录的README.md（如果需要）
    └─ 项目根目录README.md（如果是重要变更�?
    �?
步骤3: 更新README索引
    ├─ 添加新文件（创建�?
    ├─ 移除旧文件（删除�?
    ├─ 更新路径/名称（重命名/移动�?
    └─ 更新描述（修改）
    �?
步骤4: 全局搜索引用
    ├─ grep -r "文件�? .
    ├─ 找到所有引�?
    └─ 逐一更新
    �?
步骤5: 验证
    ├─ 检查所有链接有�?
    ├─ 检查README索引完整
    └─ 检查没有遗漏的引用
    �?
步骤6: 提交（可选）
    ├─ 更新CHANGELOG.md
    └─ 提交说明要包含README更新
```

---

## �?检查清�?

### 创建文件后的检查清�?

**来源**: `01-file-operations.md` - 创建文件后，确保完成

- [ ] �?更新了相关的 README.md 索引
  - [ ] 文件已添加到正确的分�?
  - [ ] 添加了简短描�?
  - [ ] 描述准确反映文件用�?
  
- [ ] �?检查了是否需要更新其他README
  - [ ] 父目录README（如果创建了新目录）
  - [ ] 项目根README（如果是重要功能�?
  - [ ] 相关模块README（如果是代码文件�?
  
- [ ] �?验证了更新的准确�?
  - [ ] 路径正确
  - [ ] 链接有效
  - [ ] 描述清晰

---

### 修改文件后的检查清�?

**来源**: `05-change-synchronization.md` - 修改文件后检查清�?

**代码修改**:
- [ ] �?代码注释已更�?
- [ ] �?README.md已更�?
- [ ] �?API文档已更新（如适用�?
- [ ] �?示例代码已更�?
- [ ] �?CHANGELOG.md已更�?

**配置修改**:
- [ ] �?配置文档已更�?
- [ ] �?配置示例已更�?
- [ ] �?默认值说明已更新
- [ ] �?README配置章节已更�?

**文档修改**:
- [ ] �?索引已更新（如标题改变）
- [ ] �?相关引用已检�?
- [ ] �?过时链接已移�?

---

### 删除文件后的检查清�?

**来源**: `05-change-synchronization.md` - 删除文件后检查清�?

- [ ] �?已从README索引中移�?
- [ ] �?已全局搜索文件�?
- [ ] �?已更新所有文档引�?
- [ ] �?已更新所有代码引�?
- [ ] �?已更新流程文档（如适用�?
- [ ] �?已在CHANGELOG记录删除

---

### 重命�?移动文件后的检查清�?

**来源**: `05-change-synchronization.md` - 重命名文件后检查清�?

- [ ] �?使用git mv保留历史
- [ ] �?全局搜索并更新文档引�?
- [ ] �?全局搜索并更新代码引�?
- [ ] �?README索引已更�?
- [ ] �?项目配置已更�?
- [ ] �?CHANGELOG.md已记录重命名
- [ ] �?团队已通知（如需要）

---

## �?常见错误

### 错误1: 创建文件忘记更新README

**错误示例**:
```bash
# 创建了新文件
create: 项目文档/3-功能说明/新功能说�?md

# 但README还是旧的
项目文档/3-功能说明/README.md: （没有新功能的索引）�?
```

**后果**:
- 文件无法被发�?
- 其他人不知道有这个文�?
- 项目文档不完�?

**正确做法**:
```bash
1. 创建文件
2. 立即更新README.md索引  �?必须
3. 验证索引正确
```

---

### 错误2: 只更新当前目录README，忘记父目录

**错误示例**:
```bash
# 创建了新目录
create: 项目文档/9-新分�?

# 更新了新目录的README
create: 项目文档/9-新分�?README.md �?

# 但忘记更新父目录README
项目文档/README.md: （没有新分类的说明）�?
```

**正确做法**:
```markdown
# 项目文档/README.md

## 📁 目录结构

- 📁 `9-新分�?` - 新分类说�? �?必须添加
```

---

### 错误3: 删除文件只删文件，不更新README

**错误示例**:
```bash
# 删除了文�?
delete: old-feature.md

# 但README索引还在
README.md: 
- [旧功能](old-feature.md) �?失效链接 �?
```

**后果**:
- 产生失效链接
- README索引不准�?
- 用户困惑

**正确做法**:
```bash
1. 删除文件
2. 从README移除索引  �?必须
3. 搜索所有引�?
4. 更新所有引�?
```

---

### 错误4: 重命名文件只改README，不搜索引用

**错误示例**:
```bash
# 重命名了文件
mv old.md new.md

# 更新了README
README.md: new.md �?

# 但其他文档还引用旧名�?
docs/guide.md: 参见 [说明](old.md) �?失效 �?
```

**正确做法**:
```bash
1. 重命名文�?
2. 更新README
3. grep -r "old.md" .  �?必须
4. 更新所有找到的引用
```

---

### 错误5: 修改了文档主题，但描述不�?

**错误示例**:
```markdown
# 文件�?部署指南"改为"Docker部署指南"
# 但README索引还是�?
- [部署指南](deployment.md) - 如何部署应用  �?不准�?�?
```

**正确做法**:
```markdown
# 应该更新描述�?
- [Docker部署指南](deployment.md) - 使用Docker和K8s部署  �?准确 �?
```

---

## 📊 总结

### README更新�?W1H

| 问题 | 答案 |
|------|------|
| **What** (更新什�? | README.md的文件索引和描述 |
| **When** (何时更新) | 创建/删除/重命�?移动文件�?|
| **Where** (更新哪里) | 文件所在目�?+ 父目�?+ 根目�?|
| **Why** (为何更新) | 保持可发现性和一致�?|
| **Who** (谁来更新) | 执行文件操作的人 |
| **How** (如何更新) | 按照5步流程：操作→确定→更新→搜索→验证 |

---

### 核心要点

1. **🔴 强制规则**: 文件操作必须同步更新README
2. **📍 多个README**: 可能需要更新多个README.md
3. **🔍 全局搜索**: 必须搜索所有引�?
4. **�?完整验证**: 确保所有链接有�?
5. **📝 记录变更**: 重要变更记录到CHANGELOG

---

### 快速参�?

```
创建文件 �?添加到README索引
修改文件 �?更新README描述（如需要）
删除文件 �?从README移除 + 更新所有引�?
重命名文�?�?更新README + 全局替换引用
移动文件 �?更新旧目录README + 新目录README
```

---

## 📚 相关规则

- **01-file-operations.md** - 文件操作强制规则（步�?: 准备更新项目索引�?
- **05-change-synchronization.md** - 变更同步规则（完整的同步要求�?
- **03-naming-convention.md** - 文件命名规范（重命名时参考）
- **02-directory-management.md** - 目录管理规范（目录操作时参考）

---

**创建日期**: 2025-11-26  
**最后更�?*: 2025-11-26  
**版本**: v1.0  
**状�?*: �?详细规则文档
