# ä½ç½®ç®¡ç†ç³»ç»Ÿè¯´æ˜

**æ–‡æ¡£ç‰ˆæœ¬**: v1.0  
**åˆ›å»ºæ—¶é—´**: 2025-11-21  
**å¯¹åº”SQL**: `04_locations.sql`, `05_rooms.sql`, `06_beds.sql`

---

## ğŸ“‹ æ¦‚è¿°

ä½ç½®ç®¡ç†ç³»ç»Ÿè´Ÿè´£ç®¡ç†å…»è€æœºæ„çš„ç‰©ç†ç©ºé—´å±‚çº§ç»“æ„ï¿½?*ä½ç½®(Location) ï¿½?æˆ¿é—´(Room) ï¿½?åºŠä½(Bed)**ï¼Œæ”¯æŒæœºæ„åœºæ™¯ï¼ˆInstitutionalï¼‰å’Œå±…å®¶åœºæ™¯ï¼ˆHomeCareï¼‰ä¸¤ç§æ¨¡å¼ï¿½?
---

## ğŸ¢ ä¸‰å±‚ç©ºé—´ç»“æ„

### å±‚çº§1ï¼šLocationï¼ˆä½ï¿½?åœ°å€ï¿½?
**ç”¨ï¿½?*: æœ€é¡¶å±‚çš„ç©ºé—´å•å…ƒï¼Œä»£è¡¨ä¸€ä¸ªç‹¬ç«‹çš„ç›‘æ§åŒºåŸŸ

**æ”¯æŒåœºæ™¯**:
- **Institutionalï¼ˆæœºæ„åœºæ™¯ï¼‰**: å…»è€é™¢æˆ¿é—´ã€å…¬å…±ç©ºï¿½?- **HomeCareï¼ˆå±…å®¶åœºæ™¯ï¼‰**: ç‹¬ç«‹ä½å®…

**å…³é”®å­—æ®µ**:
- `location_name`: ä½ç½®åç§°ï¼ˆå¦‚"E203"ï¿½?201"ï¿½?- `is_public_space`: æ˜¯å¦å…¬å…±ç©ºé—´ï¼ˆå¤§å…ã€èµ°å»Šï¼‰
- `is_multi_person_room`: æ˜¯å¦å¤šäººæˆ¿é—´
- `alert_user_ids` / `alert_tags`: å‘Šè­¦è·¯ç”±é…ç½®

**æ–‡ä»¶ä½ç½®**:
- åç«¯Model: `backend/app/models/location.py`
- åç«¯API: `backend/app/api/v1/locations.py`
- ç¤ºä¾‹æ•°æ®: `backend/app/data/locations.json`
- å‰ç«¯ç±»å‹: `frontend/src/types/index.ts:Location`

---

### å±‚çº§2ï¼šRoomï¼ˆæˆ¿é—´ï¼‰

**ç”¨ï¿½?*: Location ä¸‹çš„å­ç©ºé—´ï¼Œé€šå¸¸æ˜¯ä¸€ä¸ªç‰©ç†æˆ¿ï¿½?
**ä½¿ç”¨åœºæ™¯**:
- æœºæ„åœºæ™¯ä¸­çš„å¤šäººæˆ¿é—´éœ€è¦ç»†åˆ†æˆ¿é—´ç®¡ï¿½?- å¤§å¥—æˆ¿ä¸­çš„ä¸åŒæˆ¿é—´ï¼ˆå¦‚å®¢å…ã€å§å®¤ï¼‰

**å…³é”®å­—æ®µ**:
- `room_number`: æˆ¿é—´ï¿½?- `room_type`: æˆ¿é—´ç±»å‹ï¼ˆå§å®¤ã€å®¢å…ç­‰ï¿½?- `capacity`: å®¹çº³äººæ•°
- `is_occupied`: æ˜¯å¦å·²å ï¿½?
**æ–‡ä»¶ä½ç½®**:
- åç«¯Model: `backend/app/models/location.py:Room`
- åç«¯API: `backend/app/api/v1/locations.py`ï¼ˆroomsç«¯ç‚¹ï¿½?- ç¤ºä¾‹æ•°æ®: `backend/app/data/rooms.json`
- å‰ç«¯ç±»å‹: `frontend/src/types/index.ts:Room`

---

### å±‚çº§3ï¼šBedï¼ˆåºŠä½ï¼‰

**ç”¨ï¿½?*: æœ€å°çš„ç©ºé—´å•å…ƒï¼Œä»£è¡¨ä¸€ä¸ªåºŠä½ï¼Œç›´æ¥å…³è”ä½æˆ·

**å…³é”®ç‰¹ï¿½?*:
- **å”¯ä¸€æ€§çº¦ï¿½?*: ä¸€ä¸ªåºŠä½åªèƒ½å…³è”ä¸€ä¸ªä½ï¿½?- **åŒå‘ç»‘å®š**: 
  - `beds.resident_id` ï¿½?åºŠä½ç»‘å®šçš„ä½ï¿½?  - `residents.bed_id` ï¿½?ä½æˆ·æ‰€åœ¨çš„åºŠä½
- **è®¾å¤‡ç»‘å®š**: è®¾å¤‡å¯é€šè¿‡ `devices.bound_bed_id` ç»‘å®šåˆ°åºŠï¿½?
**å…³é”®å­—æ®µ**:
- `bed_number`: åºŠä½å·ï¼ˆï¿½?A"ï¿½?B"ï¿½?1"ï¿½?2"ï¿½?- `resident_id`: å½“å‰ä½æˆ·ID
- `is_occupied`: æ˜¯å¦å·²å ï¿½?
**æ–‡ä»¶ä½ç½®**:
- åç«¯Model: `backend/app/models/location.py:Bed`
- åç«¯API: `backend/app/api/v1/locations.py`ï¼ˆbedsç«¯ç‚¹ï¿½?- ç¤ºä¾‹æ•°æ®: `backend/app/data/beds.json`
- å‰ç«¯ç±»å‹: `frontend/src/types/index.ts:Bed`

---

## ğŸ”— ç»‘å®šè·¯å¾„æ€»ç»“

```
Location (ä½ç½®/åœ°å€)
  â”œâ”€â”€ Room (æˆ¿é—´)
  ï¿½?    â”œâ”€â”€ Bed (åºŠä½)
  ï¿½?    ï¿½?    â”œâ”€â”€ Resident (ä½æˆ·) ï¿½?residents.bed_id
  ï¿½?    ï¿½?    â””â”€â”€ Device (è®¾å¤‡) ï¿½?devices.bound_bed_id
  ï¿½?    â””â”€â”€ Device (è®¾å¤‡) ï¿½?devices.bound_room_id
  â”œâ”€â”€ Resident (ä½æˆ·) ï¿½?residents.location_id (HomeCare/å•äººï¿½?
  â””â”€â”€ Device (è®¾å¤‡) ï¿½?devices.location_id (æœªç»‘åºŠçš„è®¾å¤‡)
```

---

## ğŸ“Š æ•°æ®è¡¨ç»“ï¿½?
### Locations ï¿½?
| å­—æ®µ | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| location_id | UUID | ä¸»é”® |
| tenant_id | UUID | ç§Ÿæˆ·ID |
| location_name | String | ä½ç½®åç§° |
| location_tag | String | ä½ç½®æ ‡ç­¾ï¼ˆå¯é€‰ï¼‰ |
| building | String | æ¥¼æ ‹ï¼ˆæœºæ„åœºæ™¯ï¼‰ |
| floor | String | æ¥¼å±‚ |
| door_number | String | é—¨ç‰Œï¿½?|
| location_type | String | Institutional / HomeCare |
| is_public_space | Boolean | æ˜¯å¦å…¬å…±ç©ºé—´ |
| is_multi_person_room | Boolean | æ˜¯å¦å¤šäººæˆ¿é—´ |
| alert_user_ids | UUID[] | å‘Šè­¦æ¥æ”¶è€…ID |
| alert_tags | String[] | å‘Šè­¦æ¥æ”¶è€…æ ‡ï¿½?|
| layout_config | JSON | æˆ¿é—´å¸ƒå±€é…ç½® |
| timezone | String | æ—¶åŒº |
| is_active | Boolean | æ˜¯å¦å¯ç”¨ |

### Rooms ï¿½?
| å­—æ®µ | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| room_id | UUID | ä¸»é”® |
| tenant_id | UUID | ç§Ÿæˆ·ID |
| location_id | UUID | æ‰€å±ä½ï¿½?|
| room_number | String | æˆ¿é—´ï¿½?|
| room_type | String | æˆ¿é—´ç±»å‹ |
| capacity | Integer | å®¹çº³äººæ•° |
| floor | Integer | æ¥¼å±‚ |
| is_occupied | Boolean | æ˜¯å¦å ç”¨ |
| metadata | JSON | æ‰©å±•ä¿¡æ¯ |

### Beds ï¿½?
| å­—æ®µ | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| bed_id | UUID | ä¸»é”® |
| tenant_id | UUID | ç§Ÿæˆ·ID |
| room_id | UUID | æ‰€å±æˆ¿ï¿½?|
| bed_number | String | åºŠä½ï¿½?|
| resident_id | UUID | å½“å‰ä½æˆ· |
| is_occupied | Boolean | æ˜¯å¦å ç”¨ |
| metadata | JSON | æ‰©å±•ä¿¡æ¯ |

---

## ğŸš€ API ç«¯ç‚¹

### Locations

```bash
GET    /api/v1/locations          # è·å–ä½ç½®åˆ—è¡¨
GET    /api/v1/locations/{id}     # è·å–å•ä¸ªä½ç½®
POST   /api/v1/locations          # åˆ›å»ºä½ç½®
PUT    /api/v1/locations/{id}     # æ›´æ–°ä½ç½®
DELETE /api/v1/locations/{id}     # åˆ é™¤ä½ç½®
```

### Rooms

```bash
GET    /api/v1/rooms               # è·å–æˆ¿é—´åˆ—è¡¨
GET    /api/v1/rooms/{id}          # è·å–å•ä¸ªæˆ¿é—´
POST   /api/v1/rooms               # åˆ›å»ºæˆ¿é—´
PUT    /api/v1/rooms/{id}          # æ›´æ–°æˆ¿é—´
DELETE /api/v1/rooms/{id}          # åˆ é™¤æˆ¿é—´
```

### Beds

```bash
GET    /api/v1/beds                # è·å–åºŠä½åˆ—è¡¨
GET    /api/v1/beds/{id}           # è·å–å•ä¸ªåºŠä½
POST   /api/v1/beds                # åˆ›å»ºåºŠä½
PUT    /api/v1/beds/{id}           # æ›´æ–°åºŠä½
DELETE /api/v1/beds/{id}           # åˆ é™¤åºŠä½
```

---

## ğŸ’¡ ä½¿ç”¨åœºæ™¯ç¤ºä¾‹

### åœºæ™¯1ï¼šæœºæ„å…»è€é™¢ - å•äººæˆ¿é—´

```
Location (E203)
  â”œâ”€â”€ is_public_space: false
  â”œâ”€â”€ is_multi_person_room: false
  â””â”€â”€ Bed (A)
        â””â”€â”€ Resident (å¼ ä¸‰)
```

### åœºæ™¯2ï¼šæœºæ„å…»è€é™¢ - å¤šäººæˆ¿é—´

```
Location (201)
  â”œâ”€â”€ is_public_space: false
  â”œâ”€â”€ is_multi_person_room: true
  â”œâ”€â”€ Room (å§å®¤A)
  ï¿½?    â””â”€â”€ Bed (1)
  ï¿½?          â””â”€â”€ Resident (æå››)
  â””â”€â”€ Room (å§å®¤B)
        â””â”€â”€ Bed (1)
              â””â”€â”€ Resident (ç‹äº”)
```

### åœºæ™¯3ï¼šå…¬å…±ç©ºé—´ï¼ˆå¤§å…ï¿½?
```
Location (ä¸€æ¥¼å¤§ï¿½?
  â”œâ”€â”€ is_public_space: true
  â”œâ”€â”€ is_multi_person_room: false
  â””â”€â”€ alert_user_ids: [æŠ¤å£«ç«™å…¨ä½“äººå‘˜]
```

### åœºæ™¯4ï¼šå±…å®¶å…»ï¿½?
```
Location (Home-001)
  â”œâ”€â”€ location_type: HomeCare
  â”œâ”€â”€ primary_resident_id: èµµå…­
  â””â”€â”€ Bed (ä¸»å§ï¿½?
        â””â”€â”€ Resident (èµµå…­)
```

---

## âš ï¸ æ³¨æ„äº‹é¡¹

### åºŠä½å”¯ä¸€ï¿½?
- ä¸€ä¸ªåºŠä½åªèƒ½åˆ†é…ç»™ä¸€ä¸ªä½ï¿½?- æ›´æ–°åºŠä½å…³è”æ—¶éœ€è¦æ£€ï¿½?`is_occupied` çŠ¶ï¿½?- åˆ é™¤åºŠä½å‰éœ€è¦å…ˆè§£é™¤ä½æˆ·å…³è”

### å‘Šè­¦è·¯ç”±

- **å…¬å…±ç©ºé—´**: ä½¿ç”¨ `alert_user_ids` ï¿½?`alert_tags` è·¯ç”±
- **ç§äººç©ºé—´**: é€šè¿‡ `resident_caregivers` è¡¨æŸ¥æ‰¾è´Ÿè´£æŠ¤ï¿½?- **å¤šäººæˆ¿é—´**: å¯ä½¿ç”¨è­¦æŠ¥é€šæŠ¥ç»„æˆ–ä½æˆ·æŠ¤å£«çš„å¹¶ï¿½?
### æ•°æ®ä¸€è‡´ï¿½?
- åˆ é™¤ Location æ—¶éœ€è¦çº§è”åˆ ï¿½?Room ï¿½?Bed
- åˆ é™¤ Room æ—¶éœ€è¦çº§è”åˆ ï¿½?Bed
- åˆ é™¤ Bed æ—¶éœ€è¦è§£ï¿½?Resident å…³è”

---

## ğŸ“– ç›¸å…³æ–‡æ¡£

- æºå‚ï¿½? `owdRD_github_clone_æºå‚è€ƒæ–‡ï¿½?owlRD/db/04_locations.sql`
- æºå‚ï¿½? `owdRD_github_clone_æºå‚è€ƒæ–‡ï¿½?owlRD/db/05_rooms.sql`
- æºå‚ï¿½? `owdRD_github_clone_æºå‚è€ƒæ–‡ï¿½?owlRD/db/06_beds.sql`
- å‘Šè­¦è·¯ç”±: `owdRD_github_clone_æºå‚è€ƒæ–‡ï¿½?owlRD/README.md` (location-ï¿½?è®¾å¤‡ç»‘å®šè·¯å¾„)
- å®Œæˆåº¦æŠ¥ï¿½? `é¡¹ç›®æ–‡æ¡£/æºå‚è€ƒå¯¹ï¿½?3-å®Œæˆåº¦æŠ¥ï¿½?å½“å‰å®Œæˆåº¦æ€»è§ˆ.md`

---

**æœ€åæ›´ï¿½?*: 2025-11-21  
**ç»´æŠ¤ï¿½?*: AI Assistant
