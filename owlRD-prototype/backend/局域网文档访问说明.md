# 局域网API文档访问说明

## 问题描述
局域网其他设备访问 `http://192.168.2.6:8000/docs` 时可能出现白屏，原因是Swagger UI默认从国外CDN加载静态资源，局域网环境可能无法访问。

## 解决方案

### 方案1: 使用国内CDN版本（推荐）

访问使用国内CDN的文档页面：

**Swagger UI (国内CDN):**
```
http://192.168.2.6:8000/docs-cn
```

**ReDoc (国内CDN):**
```
http://192.168.2.6:8000/redoc-cn
```

这些页面使用了国内staticfile.org CDN镜像，局域网设备也能正常访问。

### 方案2: 配置浏览器代理

如果需要使用原生 `/docs` 页面，可以：
1. 配置浏览器使用HTTP代理
2. 或在路由器上配置DNS解析

### 方案3: 本地部署Swagger UI

下载Swagger UI静态文件到本地：
```bash
pip install fastapi[all]
```

## 访问测试

### 本机测试
```bash
# Windows
curl http://localhost:8000/docs

# 或浏览器打开
start http://localhost:8000/docs
```

### 局域网测试
```bash
# 从其他设备
curl http://192.168.2.6:8000/docs-cn

# 或浏览器打开（推荐使用国内CDN版本）
http://192.168.2.6:8000/docs-cn
```

## API端点对比

| 端点 | CDN来源 | 局域网访问 | 说明 |
|------|---------|-----------|------|
| /docs | FastAPI默认 | ❌ 可能白屏 | 使用国外CDN |
| /docs-cn | 国内staticfile.org | ✅ 正常 | 自定义页面 |
| /redoc | FastAPI默认 | ❌ 可能白屏 | 使用国外CDN |
| /redoc-cn | 国内staticfile.org | ✅ 正常 | 自定义页面 |
| /api/openapi.json | 本地 | ✅ 正常 | OpenAPI规范 |

## 常见问题

### Q: 为什么localhost能访问，局域网不能？
A: 本地浏览器可能有CDN缓存或代理配置，局域网其他设备无法访问国外CDN。

### Q: docs-cn 和 docs 有什么区别？
A: 功能完全相同，只是CDN来源不同。docs-cn使用国内镜像，更稳定。

### Q: 如何验证服务器监听状态？
A: 运行命令查看端口监听：
```bash
# Windows
netstat -ano | findstr :8000

# Linux/Mac
netstat -tuln | grep :8000
```

应该看到 `0.0.0.0:8000` 表示监听所有网络接口。

## 技术细节

### 服务器配置
```python
# backend/app/config.py
host: str = "0.0.0.0"  # 监听所有网络接口
port: int = 8000
cors_origins: List[str] = ["*"]  # 允许跨域
```

### CDN镜像
- 国内镜像: https://cdn.staticfile.org
- 官方CDN: https://cdn.jsdelivr.net

### 启动命令
```bash
cd backend
python -m uvicorn app.main:app --host 0.0.0.0 --port 8000 --reload
```

## 推荐做法

1. **开发环境**: 使用 `/docs-cn`，避免CDN问题
2. **生产环境**: 部署本地Swagger UI静态文件
3. **内网环境**: 配置内网CDN镜像或使用离线文档
